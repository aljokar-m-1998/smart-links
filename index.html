<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Page Builder Pro</title>

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Tajawal:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        /* --- Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† --- */
        :root {
            --primary: #4f46e5;
            --bg-editor: #f3f4f6;
            --bg-panel: #ffffff;
            --border: #e5e7eb;
            --text-main: #1f2937;
        }

        body { margin: 0; font-family: 'Cairo', sans-serif; background: var(--bg-editor); height: 100vh; overflow: hidden; }
        
        /* ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·) */
        body.render-mode { height: auto; overflow: auto; background: #fff; }
        #app-editor { display: flex; height: 100%; }
        body.render-mode #app-editor { display: none; }

        /* --- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… --- */
        .editor-panel {
            width: 400px; background: var(--bg-panel); border-left: 1px solid var(--border);
            display: flex; flex-direction: column; height: 100%; box-shadow: 0 0 20px rgba(0,0,0,0.05);
            z-index: 10;
        }
        .editor-header { padding: 15px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .editor-content { flex: 1; overflow-y: auto; padding: 20px; }
        .editor-footer { padding: 15px; border-top: 1px solid var(--border); background: #f9fafb; }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .section { background: #fff; border: 1px solid var(--border); border-radius: 8px; margin-bottom: 15px; overflow: hidden; }
        .section-header { padding: 12px 15px; background: #f8f9fa; cursor: pointer; font-weight: bold; display: flex; justify-content: space-between; }
        .section-body { padding: 15px; display: none; }
        .section.open .section-body { display: block; }

        /* Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ */
        .form-group { margin-bottom: 12px; }
        label { display: block; font-size: 13px; margin-bottom: 5px; color: #555; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-family: inherit; }
        
        .upload-box { border: 2px dashed #ddd; padding: 15px; text-align: center; border-radius: 6px; cursor: pointer; transition: 0.2s; position: relative; }
        .upload-box:hover { border-color: var(--primary); background: #f0f4ff; }
        .upload-box input { position: absolute; top:0; left:0; width:100%; height:100%; opacity: 0; cursor: pointer; }

        /* --- Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© --- */
        .preview-panel { flex: 1; display: flex; justify-content: center; align-items: center; background: #eef2f6; position: relative; }
        .phone-mockup {
            width: 360px; height: 750px; background: #fff; border-radius: 35px; border: 10px solid #222;
            overflow: hidden; position: relative; box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        }
        .preview-iframe { width: 100%; height: 100%; border: none; background: #fff; overflow-y: auto; }

        /* --- Ø§Ù„Ø±ÙˆØ§Ø¨Ø· --- */
        .link-item { background: #fff; border: 1px solid #eee; padding: 10px; margin-bottom: 8px; border-radius: 6px; display: flex; gap: 8px; align-items: center; }
        .handle { cursor: grab; color: #aaa; font-size: 20px; }
        .btn { border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-weight: bold; font-family: inherit; width: 100%; margin-bottom: 5px; }
        .btn-primary { background: var(--primary); color: #fff; }
        .btn-secondary { background: #6b7280; color: #fff; }
        .btn-danger { background: #fee2e2; color: #dc2626; width: auto; padding: 5px 10px; }

        /* --- Modal --- */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background: #fff; padding: 25px; border-radius: 12px; width: 90%; max-width: 400px; text-align: center; }
        
        /* RTL support */
        html[dir="ltr"] .editor-panel { border-left: none; border-right: 1px solid var(--border); }
    </style>
</head>
<body>

    <div id="app-editor">
        <div class="editor-panel">
            <div class="editor-header">
                <h3>Link Builder ğŸš€</h3>
                <button id="lang-btn" class="btn-secondary" style="width: auto; padding: 5px 10px; font-size: 12px;">English</button>
            </div>
            
            <div class="editor-content">
                
                <div class="section open">
                    <div class="section-header" onclick="toggleSection(this)">ğŸ‘¤ <span data-i18n="sec_profile">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span></div>
                    <div class="section-body">
                        <div class="form-group">
                            <label data-i18n="lbl_name">Ø§Ù„Ø§Ø³Ù…</label>
                            <input type="text" id="p-name" oninput="updateConfig()">
                        </div>
                        <div class="form-group">
                            <label data-i18n="lbl_bio">Ù†Ø¨Ø°Ø© (Bio)</label>
                            <textarea id="p-bio" rows="2" oninput="updateConfig()"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label data-i18n="lbl_avatar">Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ©</label>
                            <div class="upload-box">
                                <span id="avatar-status">ğŸ“‚ Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ ØµÙˆØ±Ø©</span>
                                <input type="file" accept="image/*" onchange="handleImageUpload(this, 'avatar')">
                            </div>
                        </div>

                        <div class="form-group">
                            <label data-i18n="lbl_cover">ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù (Banner)</label>
                            <div class="upload-box" style="border-style: solid; background: #fafafa;">
                                <span id="cover-status">ğŸ–¼ï¸ Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ ØºÙ„Ø§Ù (Ù„Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø¹Ø±ÙŠØ¶)</span>
                                <input type="file" accept="image/*" onchange="handleImageUpload(this, 'cover')">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header" onclick="toggleSection(this)">ğŸ”— <span data-i18n="sec_links">Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</span></div>
                    <div class="section-body">
                        <div id="links-container"></div>
                        <button class="btn btn-primary" onclick="addLink()" data-i18n="btn_add_link">+ Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯</button>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header" onclick="toggleSection(this)">ğŸ¨ <span data-i18n="sec_design">Ø§Ù„ØªØµÙ…ÙŠÙ…</span></div>
                    <div class="section-body">
                        <div class="form-group">
                            <label data-i18n="lbl_template">Ø§Ù„Ù‚Ø§Ù„Ø¨</label>
                            <select id="d-template" onchange="updateConfig()">
                                <option value="classic">Ø§Ù„ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ (Classic)</option>
                                <option value="hero">Ø§Ù„Ø¨Ø§Ù†Ø± Ø§Ù„Ø¹Ø±ÙŠØ¶ (Hero)</option>
                                <option value="grid">Ø´Ø¨ÙƒØ© Ù…Ø±Ø¨Ø¹Ø§Øª (Bento Grid)</option>
                                <option value="glass">Ø²Ø¬Ø§Ø¬ÙŠ Ø´ÙØ§Ù (Glassmorphism)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label data-i18n="lbl_theme">Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù†</label>
                            <select id="d-theme" onchange="updateConfig()">
                                <option value="light">ÙØ§ØªØ­ (Light)</option>
                                <option value="dark">Ø¯Ø§ÙƒÙ† (Dark)</option>
                                <option value="ocean">Ù…Ø­ÙŠØ· Ø£Ø²Ø±Ù‚ (Ocean)</option>
                                <option value="sunset">ØºØ±ÙˆØ¨ Ø§Ù„Ø´Ù…Ø³ (Sunset)</option>
                            </select>
                        </div>

                        <div class="form-group">
                             <label>ØªØ®ØµÙŠØµ Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ©</label>
                             <input type="color" id="d-custom-bg" oninput="updateConfig()" value="#f3f4f6">
                        </div>
                    </div>
                </div>

            </div>

            <div class="editor-footer">
                <button class="btn btn-primary" onclick="generateShareLink()" data-i18n="btn_share">Ø­ÙØ¸ ÙˆÙ…Ø´Ø§Ø±ÙƒØ© ğŸ”—</button>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button class="btn btn-secondary" onclick="downloadHTML()" data-i18n="btn_download">ØªØ­Ù…ÙŠÙ„ HTML ğŸ“¥</button>
                </div>
            </div>
        </div>

        <div class="preview-panel">
            <div class="phone-mockup">
                <iframe id="preview-frame" class="preview-iframe"></iframe>
            </div>
        </div>
    </div>

    <div id="share-modal" class="modal">
        <div class="modal-content">
            <h3>Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©! ğŸ‰</h3>
            <div id="qrcode" style="margin: 20px auto; display: flex; justify-content: center;"></div>
            <input type="text" id="share-url" readonly style="width: 100%; margin-bottom: 10px; direction: ltr;">
            <button class="btn btn-primary" onclick="copyLink()">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
            <button class="btn btn-secondary" onclick="document.getElementById('share-modal').style.display='none'" style="margin-top: 10px;">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <script>
        // --- 1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„ØºØ© ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ---
        let lang = 'ar';
        const translations = {
            ar: {
                sec_profile: 'Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ', lbl_name: 'Ø§Ù„Ø§Ø³Ù…', lbl_bio: 'Ù†Ø¨Ø°Ø©', lbl_avatar: 'Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ©', lbl_cover: 'ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù (Banner)',
                sec_links: 'Ø§Ù„Ø±ÙˆØ§Ø¨Ø·', btn_add_link: '+ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø·',
                sec_design: 'Ø§Ù„ØªØµÙ…ÙŠÙ…', lbl_template: 'Ø§Ù„Ù‚Ø§Ù„Ø¨', lbl_theme: 'Ø§Ù„Ø£Ù„ÙˆØ§Ù†',
                btn_share: 'Ø­ÙØ¸ ÙˆÙ…Ø´Ø§Ø±ÙƒØ© ğŸ”—', btn_download: 'ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù HTML ğŸ“¥'
            },
            en: {
                sec_profile: 'Profile', lbl_name: 'Name', lbl_bio: 'Bio', lbl_avatar: 'Avatar', lbl_cover: 'Cover Image',
                sec_links: 'Links', btn_add_link: '+ Add Link',
                sec_design: 'Design', lbl_template: 'Template', lbl_theme: 'Color Theme',
                btn_share: 'Save & Share ğŸ”—', btn_download: 'Download HTML ğŸ“¥'
            }
        };

        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        let config = {
            profile: { name: 'Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§', bio: 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØµÙØ­ØªÙŠ Ø§Ù„Ø®Ø§ØµØ©', avatar: '', cover: '' },
            links: [{ title: 'Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ğŸŒ', url: 'https://google.com' }],
            design: { template: 'classic', theme: 'light', customBg: '#f3f4f6' }
        };

        // --- 2. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø±Ø± (Editor Logic) ---
        
        function initEditor() {
            // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª Ù„Ù„Ø±ÙˆØ§Ø¨Ø·
            new Sortable(document.getElementById('links-container'), {
                handle: '.handle', animation: 150, onEnd: updateConfigFromDOM
            });

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            document.getElementById('p-name').value = config.profile.name;
            document.getElementById('p-bio').value = config.profile.bio;
            renderLinksInputs();
            updatePreview();

            // Ø²Ø± Ø§Ù„Ù„ØºØ©
            document.getElementById('lang-btn').onclick = toggleLang;
        }

        function toggleSection(header) {
            header.parentElement.classList.toggle('open');
        }

        function toggleLang() {
            lang = lang === 'ar' ? 'en' : 'ar';
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.getElementById('lang-btn').innerText = lang === 'ar' ? 'English' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©';
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØµÙˆØµ
            document.querySelectorAll('[data-i18n]').forEach(el => {
                el.innerText = translations[lang][el.dataset.i18n];
            });
            updatePreview(); // Ù„ØªØ­Ø¯ÙŠØ« Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¶
        }

        // --- Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ± ---
        function handleImageUpload(input, type) {
            const file = input.files[0];
            if (!file) return;
            
            // ØªØ­Ø°ÙŠØ± Ù„Ù„Ø­Ø¬Ù…
            if(file.size > 500 * 1024) { alert('âš ï¸ Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ØŒ ÙŠÙØ¶Ù„ Ø£Ù‚Ù„ Ù…Ù† 500KB Ù„Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„'); }

            const reader = new FileReader();
            reader.onload = (e) => {
                config.profile[type] = e.target.result;
                document.getElementById(`${type}-status`).innerText = 'âœ… ØªÙ… Ø§Ù„Ø±ÙØ¹';
                updatePreview();
            };
            reader.readAsDataURL(file);
        }

        // --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ---
        function renderLinksInputs() {
            const container = document.getElementById('links-container');
            container.innerHTML = '';
            config.links.forEach((link, index) => {
                const div = document.createElement('div');
                div.className = 'link-item';
                div.innerHTML = `
                    <span class="handle">â˜°</span>
                    <div style="flex:1">
                        <input type="text" value="${link.title}" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†" oninput="updateLink(${index}, 'title', this.value)">
                        <input type="text" value="${link.url}" placeholder="Ø§Ù„Ø±Ø§Ø¨Ø·" style="margin-top:5px" oninput="updateLink(${index}, 'url', this.value)">
                    </div>
                    <button class="btn-danger" onclick="removeLink(${index})">ğŸ—‘ï¸</button>
                `;
                container.appendChild(div);
            });
        }

        function addLink() {
            config.links.push({ title: 'Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯', url: '' });
            renderLinksInputs();
            updatePreview();
        }

        function removeLink(index) {
            config.links.splice(index, 1);
            renderLinksInputs();
            updatePreview();
        }

        function updateLink(index, key, value) {
            config.links[index][key] = value;
            updatePreview(); // ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ
        }

        function updateConfigFromDOM() {
            // ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¤Ù‡Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…ØµÙÙˆÙØ©
            const items = document.querySelectorAll('.link-item');
            const newLinks = [];
            items.forEach(item => {
                const title = item.querySelector('input[placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"]').value;
                const url = item.querySelector('input[placeholder="Ø§Ù„Ø±Ø§Ø¨Ø·"]').value;
                newLinks.push({ title, url });
            });
            config.links = newLinks;
            updatePreview();
        }

        function updateConfig() {
            config.profile.name = document.getElementById('p-name').value;
            config.profile.bio = document.getElementById('p-bio').value;
            config.design.template = document.getElementById('d-template').value;
            config.design.theme = document.getElementById('d-theme').value;
            config.design.customBg = document.getElementById('d-custom-bg').value;
            updatePreview();
        }

        // --- 3. Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© ÙˆØ§Ù„ØªÙˆÙ„ÙŠØ¯ (Core Rendering) ---
        
        function generateFullPageHTML(data) {
            // Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø© ØªÙˆÙ„Ø¯ ÙƒÙˆØ¯ HTML Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
            
            const { profile, links, design } = data;
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø«ÙŠÙ…
            const themes = {
                light: { bg: '#ffffff', text: '#333', btnBg: '#f3f4f6', btnText: '#000' },
                dark: { bg: '#111827', text: '#f9fafb', btnBg: '#1f2937', btnText: '#fff' },
                ocean: { bg: 'linear-gradient(to bottom, #e0f7fa, #80deea)', text: '#006064', btnBg: '#ffffff', btnText: '#00838f' },
                sunset: { bg: 'linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%)', text: '#4a001f', btnBg: 'rgba(255,255,255,0.8)', btnText: '#d63384' }
            };
            
            let currentTheme = themes[design.theme];
            // ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø®Ù„ÙÙŠØ© Ø¥Ø°Ø§ ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ù„ÙˆÙ† Ù…Ø®ØµØµ Ù…Ø¹ Ø§Ù„Ø«ÙŠÙ… Ø§Ù„ÙØ§ØªØ­
            if(design.theme === 'light' && design.customBg !== '#f3f4f6') {
                currentTheme.bg = design.customBg;
            }

            // CSS Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
            let templateCSS = '';
            let layoutHTML = '';

            const avatarHTML = profile.avatar ? `<img src="${profile.avatar}" class="avatar">` : `<div class="avatar" style="background:#ddd;display:flex;align-items:center;justify-content:center;font-size:30px;">ğŸ‘¤</div>`;
            const coverHTML = profile.cover ? `background-image: url('${profile.cover}');` : `background-color: var(--btn-bg);`;

            // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
            const linksHTML = links.map(l => `
                <a href="${l.url}" target="_blank" class="link-card">
                    <span>${l.title}</span>
                </a>
            `).join('');

            // --- Ù…Ù†Ø·Ù‚ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ ---
            
            if (design.template === 'hero') {
                // Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø¨Ø§Ù†Ø± Ø§Ù„Ø¹Ø±ÙŠØ¶
                templateCSS = `
                    .hero { height: 180px; width: 100%; background-size: cover; background-position: center; ${coverHTML} }
                    .profile-container { margin-top: -60px; text-align: center; padding: 0 20px; }
                    .avatar { width: 120px; height: 120px; border-radius: 50%; border: 4px solid var(--bg); object-fit: cover; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
                    .links-container { padding: 20px; max-width: 600px; margin: 0 auto; display: flex; flex-direction: column; gap: 15px; }
                    .link-card { background: var(--btn-bg); color: var(--btn-text); padding: 18px; border-radius: 50px; text-decoration: none; font-weight: bold; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: transform 0.2s; display: block; }
                    .link-card:hover { transform: translateY(-3px); }
                `;
                layoutHTML = `
                    <div class="hero"></div>
                    <div class="profile-container">
                        ${avatarHTML}
                        <h1>${profile.name}</h1>
                        <p>${profile.bio}</p>
                    </div>
                    <div class="links-container">${linksHTML}</div>
                `;

            } else if (design.template === 'grid') {
                // Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø´Ø¨ÙƒØ© (Bento Grid)
                templateCSS = `
                    .container { max-width: 600px; margin: 40px auto; padding: 20px; text-align: center; }
                    .avatar { width: 100px; height: 100px; border-radius: 25%; object-fit: cover; margin-bottom: 15px; }
                    .links-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 30px; }
                    .link-card { background: var(--btn-bg); color: var(--btn-text); padding: 30px 15px; border-radius: 20px; text-decoration: none; font-weight: bold; display: flex; align-items: center; justify-content: center; text-align: center; aspect-ratio: 1/1; box-shadow: 0 4px 12px rgba(0,0,0,0.08); transition: 0.3s; }
                    .link-card:hover { transform: scale(1.03); }
                `;
                layoutHTML = `
                    <div class="container">
                        ${avatarHTML}
                        <h1>${profile.name}</h1>
                        <p>${profile.bio}</p>
                        <div class="links-container">${linksHTML}</div>
                    </div>
                `;

            } else if (design.template === 'glass') {
                // Ù‚Ø§Ù„Ø¨ Ø²Ø¬Ø§Ø¬ÙŠ
                templateCSS = `
                    body { background: url('https://source.unsplash.com/random/1920x1080/?abstract,gradient') no-repeat center center fixed; background-size: cover; }
                    .container { max-width: 500px; margin: 60px auto; padding: 40px 30px; text-align: center; background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(15px); border-radius: 20px; border: 1px solid rgba(255,255,255,0.2); box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37); color: #fff; }
                    .avatar { width: 110px; height: 110px; border-radius: 50%; object-fit: cover; border: 3px solid rgba(255,255,255,0.5); }
                    .link-card { background: rgba(255, 255, 255, 0.25); color: #fff; margin-top: 15px; padding: 15px; border-radius: 12px; text-decoration: none; display: block; font-weight: bold; border: 1px solid rgba(255,255,255,0.1); transition: 0.2s; }
                    .link-card:hover { background: rgba(255, 255, 255, 0.4); }
                    h1, p { color: #fff; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
                `;
                // Ù‡Ù†Ø§ Ù†ØªØ¬Ø§Ù‡Ù„ Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø«ÙŠÙ… Ù„Ø£Ù† Ø§Ù„Ù‚Ø§Ù„Ø¨ Ù„Ù‡ Ø®Ù„ÙÙŠØ© Ø®Ø§ØµØ©
                currentTheme.bg = 'transparent'; 
                layoutHTML = `
                    <div class="container">
                        ${avatarHTML}
                        <h1>${profile.name}</h1>
                        <p>${profile.bio}</p>
                        <div class="links-container">${linksHTML}</div>
                    </div>
                `;

            } else {
                // Ø§Ù„ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ
                templateCSS = `
                    .container { max-width: 500px; margin: 50px auto; padding: 20px; text-align: center; }
                    .avatar { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; margin-bottom: 15px; }
                    .links-container { display: flex; flex-direction: column; gap: 12px; margin-top: 25px; }
                    .link-card { background: var(--btn-bg); color: var(--btn-text); padding: 16px; border-radius: 8px; text-decoration: none; font-weight: bold; border: 1px solid rgba(0,0,0,0.05); transition: 0.2s; display: block; }
                    .link-card:hover { opacity: 0.9; }
                `;
                layoutHTML = `
                    <div class="container">
                        ${avatarHTML}
                        <h1>${profile.name}</h1>
                        <p>${profile.bio}</p>
                        <div class="links-container">${linksHTML}</div>
                    </div>
                `;
            }

            // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
            return `
<!DOCTYPE html>
<html dir="auto">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${profile.name}</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: ${currentTheme.bg};
            --text: ${currentTheme.text};
            --btn-bg: ${currentTheme.btnBg};
            --btn-text: ${currentTheme.btnText};
        }
        body { margin: 0; font-family: 'Cairo', sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; }
        h1 { margin: 10px 0 5px; font-size: 24px; }
        p { margin: 0 0 20px; opacity: 0.8; font-size: 14px; }
        ${templateCSS}
    </style>
</head>
<body>
    ${layoutHTML}
</body>
</html>`;
        }

        function updatePreview() {
            const html = generateFullPageHTML(config);
            const frame = document.getElementById('preview-frame');
            const doc = frame.contentDocument || frame.contentWindow.document;
            doc.open();
            doc.write(html);
            doc.close();
        }

        // --- 4. Ø§Ù„ØªØµØ¯ÙŠØ± ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ---

        function generateShareLink() {
            // Ø¶ØºØ· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·
            const json = JSON.stringify(config);
            const compressed = LZString.compressToEncodedURIComponent(json);
            const url = `${window.location.origin}${window.location.pathname}#data=${compressed}`;
            
            document.getElementById('share-url').value = url;
            
            // QR Code
            const qrContainer = document.getElementById('qrcode');
            qrContainer.innerHTML = '';
            new QRCode(qrContainer, { text: url, width: 128, height: 128 });
            
            document.getElementById('share-modal').style.display = 'flex';
        }

        function downloadHTML() {
            const html = generateFullPageHTML(config);
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'my-links.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function copyLink() {
            const copyText = document.getElementById("share-url");
            copyText.select();
            document.execCommand("copy");
            alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·! ğŸ‰");
        }

        // --- 5. Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ (Router) ---
        
        window.onload = function() {
            if (window.location.hash.startsWith('#data=')) {
                // ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ (Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯)
                try {
                    const compressed = window.location.hash.substring(6);
                    const json = LZString.decompressFromEncodedURIComponent(compressed);
                    const data = JSON.parse(json);
                    
                    document.body.classList.add('render-mode');
                    document.body.innerHTML = generateFullPageHTML(data);
                } catch (e) {
                    console.error(e);
                    alert("Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­ Ø£Ùˆ ØªØ§Ù„Ù");
                    window.location.hash = "";
                    location.reload();
                }
            } else {
                // ÙˆØ¶Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ (Editor)
                initEditor();
            }
        };

    </script>
</body>
</html>