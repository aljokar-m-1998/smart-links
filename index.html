<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙÙ†Ø´Ø¦ ØµÙØ­Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø°ÙƒÙŠØ© - Pro</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Almarai:wght@400;700&family=Cairo:wght@400;700;900&family=Tajawal:wght@400;700&family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        /* --- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ§Ù„ØªØµÙ…ÙŠÙ… (CSS) --- */
        :root {
            --editor-bg: #f7f8fa;
            --preview-bg: #eef0f5;
            --widget-bg: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #555;
            --border-color: #e0e0e0;
            --accent-color: #007bff;
            --accent-hover: #0056b3;
            --danger-color: #dc3545;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --border-radius: 12px;
        }

        body {
            font-family: 'Cairo', sans-serif;
            margin: 0;
            background-color: var(--editor-bg);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            display: flex;
            transition: direction 0.3s;
        }
        body.en-mode { direction: ltr; font-family: 'Poppins', sans-serif; }
        body.en-mode #editor-panel { border-left: none; border-right: 1px solid var(--border-color); box-shadow: 5px 0 15px rgba(0,0,0,0.05); }

        #app-container { display: flex; width: 100%; height: 100%; }

        #editor-panel {
            width: 450px;
            height: 100%;
            overflow-y: auto;
            background-color: var(--widget-bg);
            padding: 25px;
            border-left: 1px solid var(--border-color);
            box-shadow: -5px 0 15px rgba(0,0,0,0.05);
            box-sizing: border-box;
        }

        .editor-section {
            background: var(--editor-bg);
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }
        
        .editor-section summary {
            font-weight: 700; padding: 15px; cursor: pointer; list-style: none;
            display: flex; justify-content: space-between; align-items: center; background: #fff;
        }
        
        .form-content { padding: 15px; border-top: 1px solid var(--border-color); }
        
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-size: 14px; font-weight: 700; margin-bottom: 8px; color: var(--text-secondary); }
        
        input[type="text"], input[type="url"], textarea, select {
            width: 100%; padding: 10px; border: 1px solid var(--border-color);
            border-radius: 8px; background: #fff; box-sizing: border-box; transition: 0.2s;
            font-family: inherit;
        }
        
        .btn {
            padding: 10px 18px; border: none; border-radius: 8px; cursor: pointer;
            font-weight: 700; transition: all 0.2s; display: inline-flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-primary { background-color: var(--accent-color); color: white; }
        .btn-secondary { background-color: #6c757d; color: white; }
        .btn-danger { background: transparent; color: var(--danger-color); border: 1px solid var(--danger-color);}
        .btn-success { background-color: #28a745; color: white; }
        .btn-full { width: 100%; }

        #links-list .link-item {
            background-color: #fff; padding: 10px; border: 1px solid var(--border-color);
            border-radius: 8px; margin-bottom: 10px; display: flex; align-items: center; gap: 10px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .drag-handle { cursor: grab; color: #aaa; font-size: 20px; padding: 0 5px; }
        .sortable-ghost { opacity: 0.4; background: #e0f0ff; }

        #preview-panel {
            flex-grow: 1; display: flex; justify-content: center; align-items: center; background-color: var(--preview-bg);
            padding: 20px; height: 100%; overflow: hidden;
        }
        #preview-frame {
            width: 375px; height: 812px; background-color: white; border-radius: 40px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.15); padding: 15px; box-sizing: border-box;
            position: relative; border: 8px solid #333;
        }
        #preview-content {
            width: 100%; height: 100%; background-color: #f0f0f0; border-radius: 30px;
            overflow-y: auto; text-align: center; padding: 40px 15px; box-sizing: border-box;
        }
        #preview-content::-webkit-scrollbar { display: none; }
        
        #html-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 1000; }
        #html-modal-content { background: white; padding: 30px; border-radius: var(--border-radius); width: 90%; max-width: 700px; text-align: center; animation: slideUp 0.3s ease; }
        #html-modal-content textarea { direction: ltr; text-align: left; font-family: monospace; }

        #toast { visibility: hidden; min-width: 250px; background-color: #333; color: #fff; text-align: center; border-radius: 8px; padding: 16px; position: fixed; z-index: 2000; left: 50%; bottom: 30px; transform: translateX(-50%); font-size: 15px; box-shadow: 0 4px 12px rgba(0,40,80,0.2); }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

        body.render-mode { display: block; height: auto; overflow: auto; background: #fff; }
        body.render-mode #app-container { display: none; }
        #render-container { display: none; }
        body.render-mode #render-container { display: block; }
        
        @media (max-width: 900px) {
            #app-container { flex-direction: column; }
            #editor-panel { width: 100%; height: auto; border-left: none; border-right: none; }
            #preview-panel { height: 100vh; position: sticky; top: 0; z-index: 10; border-top: 1px solid #ddd;}
        }

    </style>
</head>
<body>

    <div id="toast">ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­</div>

    <div id="app-container">
        <div id="editor-panel">
            
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h1 id="editor-h1">ğŸ› ï¸ Ù…Ø­Ø±Ø± Ø§Ù„ØµÙØ­Ø©</h1>
                <button id="lang-toggle-btn" class="btn btn-secondary">English ğŸ‡ºğŸ‡¸</button>
            </div>
            
            <details class="editor-section" open id="section-personal">
                <summary data-i18n="section-personal">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</summary>
                <div class="form-content">
                    <div class="form-group">
                        <label data-i18n="label-name">Ø§Ù„Ø§Ø³Ù…</label>
                        <input type="text" id="profile-name" data-i18n-placeholder="placeholder-name" placeholder="Ø§Ø³Ù…Ùƒ Ø£Ùˆ Ø¹Ù„Ø§Ù…ØªÙƒ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©">
                    </div>
                    <div class="form-group">
                        <label data-i18n="label-bio">Ù†Ø¨Ø°Ø© (Bio)</label>
                        <textarea id="profile-bio" data-i18n-placeholder="placeholder-bio" placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ±..."></textarea>
                    </div>
                    <div class="form-group">
                        <label data-i18n="label-avatar">Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ©</label>
                        
                        <input type="url" id="profile-avatar-url" data-i18n-placeholder="placeholder-avatar-url" placeholder="Ø£Ùˆ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (Ù„ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·)">
                        
                        <p style="text-align: center; margin: 5px 0; font-size: 12px; color: #888;" data-i18n="text-or">--- Ø£Ùˆ ---</p>
                        
                        <div class="file-upload-wrapper">
                            <div class="file-upload-btn" id="upload-btn-text" data-i18n="btn-upload-file">Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ ğŸ“ (Ù‚Ø¯ ÙŠØ·ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·)</div>
                            <input type="file" id="profile-avatar-upload" accept="image/*">
                        </div>
                        
                        <button id="delete-avatar-btn" class="btn btn-danger btn-full" style="margin-top: 10px; display:none;">
                            ğŸ—‘ï¸ <span data-i18n="btn-delete-avatar">Ø­Ø°Ù Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ©</span>
                        </button>
                    </div>

                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" id="hide-name-check"> <span data-i18n="check-hide-name">Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ø³Ù…</span>
                        </label>
                        <label>
                            <input type="checkbox" id="hide-bio-check"> <span data-i18n="check-hide-bio">Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ø¨Ø°Ø©</span>
                        </label>
                    </div>
                </div>
            </details>
            
            <details class="editor-section" id="section-social">
                <summary data-i18n="section-social">Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</summary>
                <div class="form-content" id="social-links-list"></div>
            </details>

            <details class="editor-section" open id="section-links">
                <summary data-i18n="section-links">Ø§Ù„Ø±ÙˆØ§Ø¨Ø· (Ø§Ø³Ø­Ø¨ Ù„Ù„ØªØ±ØªÙŠØ¨)</summary>
                <div class="form-content">
                    <div id="links-list"></div>
                    <button id="add-link-btn" class="btn btn-primary btn-full" data-i18n="btn-add-link">
                         Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯ â•
                    </button>
                </div>
            </details>

            <details class="editor-section" open id="section-design">
                <summary data-i18n="section-design">Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù†</summary>
                <div class="form-content">
                     <div class="form-group">
                        <label data-i18n="label-theme">Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ø¬Ø§Ù‡Ø²</label>
                        <select id="theme-selector">
                            <option value="light" data-i18n="opt-light">ÙØ§ØªØ­ (Light)</option>
                            <option value="dark" data-i18n="opt-dark">Ø¯Ø§ÙƒÙ† (Dark)</option>
                            <option value="simple-pro" data-i18n="opt-simple-pro">â­ï¸ Ø§Ø­ØªØ±Ø§ÙÙŠ (Ù†ØµÙŠ)</option>
                            <option value="motion-pro" data-i18n="opt-motion-pro">âœ¨ Ù…Ù…ÙŠØ² (Ø­Ø±ÙƒÙŠ)</option>
                            <option value="blue" data-i18n="opt-blue">Ø£Ø²Ø±Ù‚ Ù…Ø­ÙŠØ·ÙŠ</option>
                            <option value="pink" data-i18n="opt-pink">ØªØ¯Ø±Ø¬ ÙˆØ±Ø¯ÙŠ</option>
                            <option value="elegant" data-i18n="opt-elegant">Ø£Ø³ÙˆØ¯ ÙˆØ°Ù‡Ø¨ÙŠ</option>
                            <option value="custom" data-i18n="opt-custom" disabled>Ù…Ø®ØµØµ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label data-i18n="label-colors">ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ù„ÙˆØ§Ù†</label>
                        <div class="color-picker-group">
                            <input type="color" id="bg-color" data-i18n-title="title-bg-color" title="Ø§Ù„Ø®Ù„ÙÙŠØ©">
                            <input type="color" id="link-bg-color" data-i18n-title="title-link-bg-color" title="Ø®Ù„ÙÙŠØ© Ø§Ù„Ø²Ø±">
                            <input type="color" id="link-text-color" data-i18n-title="title-link-text-color" title="Ù†Øµ Ø§Ù„Ø²Ø±">
                            <input type="color" id="text-color" data-i18n-title="title-text-color" title="Ø§Ù„Ù†Øµ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ">
                        </div>
                    </div>
                    <div class="form-group">
                        <label data-i18n="label-button-style">Ø´ÙƒÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±</label>
                        <select id="button-style-selector">
                            <option value="8px" data-i18n="opt-soft-edges">Ø­ÙˆØ§Ù Ù†Ø§Ø¹Ù…Ø©</option>
                            <option value="25px" data-i18n="opt-full-round">Ø¯Ø§Ø¦Ø±ÙŠ ÙƒØ§Ù…Ù„</option>
                            <option value="0px" data-i18n="opt-sharp-square">Ù…Ø±Ø¨Ø¹ Ø­Ø§Ø¯</option>
                            <option value="neubrutalism" data-i18n="opt-neubrutalism">ØªØµÙ…ÙŠÙ… Ø­Ø§Ø¯ (Neubrutalism)</option>
                        </select>
                    </div>
                </div>
            </details>

            <div class="actions" style="margin-top: 25px; display: flex; gap: 10px; flex-wrap: wrap;">
                <button id="generate-link-btn" class="btn btn-primary" style="flex:1;"><span data-i18n="btn-share">Ø­ÙØ¸ ÙˆÙ…Ø´Ø§Ø±ÙƒØ©</span> ğŸš€</button>
                <button id="shorten-btn" class="btn btn-success" style="flex:1;"><span data-i18n="btn-shorten">ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·</span> âœ‚ï¸</button>
                <button id="download-html-btn" class="btn btn-secondary" style="flex:1;"><span data-i18n="btn-download-html">ØªØ­Ù…ÙŠÙ„ HTML</span> ğŸ’¾</button>
                <button id="copy-html-btn" class="btn btn-secondary" style="flex:1;"><span data-i18n="btn-copy-html">Ù†Ø³Ø® ÙƒÙˆØ¯ HTML</span> ğŸ“‹</button>
            </div>
            
            <div style="margin-top: 20px; font-size: 12px; color: #888; text-align: center;">
                * <span data-i18n="notice-long-url">ÙŠÙÙ†ØµØ­ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… "Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ù…Ø¨Ø§Ø´Ø±" Ù„ØªÙ…ÙƒÙŠÙ† Ø®Ø§ØµÙŠØ© ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·.</span>
                <span id="saved-status" style="display: block; margin-top: 5px; font-weight: bold; color: #007bff;"></span>
            </div>
        </div>

        <div id="preview-panel">
            <div id="preview-frame">
                <div id="preview-content">
                    </div>
            </div>
        </div>
    </div>

    <div id="render-container"></div>
    
    <div id="modal">
        <div id="modal-content">
            <h2 data-i18n="modal-ready-h2">âœ¨ ØµÙØ­ØªÙƒ Ø¬Ø§Ù‡Ø²Ø©!</h2>
            <p data-i18n="modal-ready-p">Ø§Ù…Ø³Ø­ Ø§Ù„ÙƒÙˆØ¯ Ø£Ùˆ Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ø¯Ù†Ø§Ù‡:</p>
            <div id="qrcode-container"></div>
            <input type="text" id="generated-link" readonly style="direction: ltr; text-align: center; margin-bottom: 10px;">
            <div style="display: flex; gap: 10px;">
                <button id="copy-link-btn" class="btn btn-primary" style="flex:1;" data-i18n="btn-copy-link">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
                <button id="close-modal-btn" class="btn btn-secondary" style="flex:1;" data-i18n="btn-close">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
            <p style="font-size: 12px; margin-top: 15px; color: #555;" data-i18n="notice-long-link">(Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¸Ø§Ù‡Ø± Ø·ÙˆÙŠÙ„Ø§Ù‹ØŒ ÙÙ‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªÙŠ Ø±ÙØ¹ØªÙ‡Ø§ ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹.)</p>
        </div>
    </div>
    
    <div id="html-modal">
        <div id="html-modal-content">
            <h2 data-i18n="html-modal-h2">ğŸ“ ÙƒÙˆØ¯ HTML Ø¬Ø§Ù‡Ø²</h2>
            <p data-i18n="html-modal-p">Ø§Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ Ø£Ø¯Ù†Ø§Ù‡ ÙˆÙ‚Ù… Ø¨Ø±ÙØ¹Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ Ø§Ø³ØªØ¶Ø§ÙØªÙƒ:</p>
            <textarea id="final-html-code" readonly style="width: 100%; height: 300px;"></textarea>
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button id="copy-code-btn" class="btn btn-primary" style="flex:1;" data-i18n="btn-copy-code">Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„</button>
                <button id="close-html-modal-btn" class="btn btn-secondary" style="flex:1;" data-i18n="btn-close">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
        </div>
    </div>

    <script>
        
        // --- 1. Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙˆØ§Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ø«ÙŠÙ…Ø§Øª (Ù…ÙØµØ­Ù‘ÙØ­Ø©) ---
        
        const themes = {
            'light': { bg: '#f7f8fa', lBg: '#ffffff', lTxt: '#1a1a1a', txt: '#1a1a1a', font: 'Cairo' },
            'dark': { bg: '#121212', lBg: '#2a2a2a', lTxt: '#ffffff', txt: '#ffffff', font: 'Cairo' },
            'simple-pro': { bg: '#f9f9f9', lBg: '#000000', lTxt: '#ffffff', txt: '#333333', btnRadius: '25px', font: 'Tajawal' },
            'motion-pro': { bg: 'linear-gradient(180deg, #1e3c72 0%, #2a5298 100%)', lBg: 'rgba(255,255,255,0.95)', lTxt: '#2a5298', txt: '#ffffff', btnRadius: '12px', font: 'Poppins' },
            'blue': { bg: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', lBg: 'rgba(255,255,255,0.9)', lTxt: '#4a4a4a', txt: '#ffffff', font: 'Cairo' },
            'pink': { bg: 'linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%)', lBg: '#fff0f3', lTxt: '#d63384', txt: '#4a001f', font: 'Almarai' },
            'elegant': { bg: '#000000', lBg: '#D4AF37', lTxt: '#000000', txt: '#D4AF37', font: 'Poppins' }
        };

        // ØªÙ… Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ØªØ³ØªØ®Ø¯Ù… stroke="currentColor" Ø£Ùˆ fill="currentColor" Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
        const svgs = {
            twitter: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2 1.3-1.4 1.2-3.3.4-5.1-1.3-3.7-5.8-5.7-9.4-4.5 1.1 2 2 4.4 2.8 6.9 1.1 3.5.5 7.4-1.4 10.3 3.6 1.4 7.4.4 10-2 .6-.6 1.1-1.2 1.5-1.9.9.5 2 1 3.2 1.4C17.6 19.3 20 18 22 17"/></svg>',
            instagram: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>',
            facebook: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3V2z"/></svg>',
            linkedin: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M16 8a6 6 0 0 0-6 6v7h-4v-7a6 6 0 0 0-6-6 6 6 0 0 0 6 6v7h4v-7a6 6 0 0 0 6-6zM4 2h4v4H4z"/></svg>',
            // ØªÙ… ØªØµØ­ÙŠØ­ Ø§Ù„Ù€ SVG Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø³Ù„ÙŠÙ…
            whatsapp: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm-1.87 14.896c-.3-.15-.88-.43-1.02-.48a1 1 0 0 1-.58-.33c-.2-.23-.74-.89-.98-1.07a.999.999 0 0 1-.37-.58c-.1-.28 0-.58.17-.85s.58-.85.83-1.09c.25-.24.49-.3.68-.3s.4-.04.61.42c.2.46.39 1.09.43 1.19s.08.2.03.42c-.05.2-.26.24-.51.48s-.54.49-.75.72c-.2.23-.42.45-.64.67-.17.16-.35.33-.52.48a.999.999 0 0 0-.25.59c.02.19.14.3.29.45.15.15.36.35.54.51.18.17.37.33.58.49.23.18.47.36.71.55.24.19.49.38.75.56.26.18.52.36.78.53.25.17.51.34.77.5.25.17.51.32.77.47.26.15.52.3.78.44.25.14.5.27.75.39.25.12.5.24.75.36.25.12.49.23.74.34.25.1.49.19.74.28.25.09.49.17.74.25.25.08.49.16.74.24.25.07.49.14.74.2c.25.07.49.13.74.19.24.06.49.11.74.16.24.05.49.09.74.14.24.05.49.09.74.12.24.03.49.06.74.09.24.03.49.05.74.07.24.02.49.03.74.04.24.01.49.01.74.02.24 0 .49 0 .74 0h.22c.55 0 1-.45 1-1v-.22c0-.55-.45-1-1-1H12.7c-.52 0-.82-.24-1.14-.54-.32-.3-.68-.62-1.04-.98-.36-.36-.72-.72-1.04-1.04-.3-.32-.54-.62-.54-1.14z"/></svg>',
        };
        
        // --- Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© (Helper Functions) ---

        function escapeHtml(text) {
            if (text === undefined || text === null) return "";
            const str = String(text); 
            return str
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        function showToast(message) {
            const x = document.getElementById("toast");
            x.textContent = message;
            x.className = "show";
            setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
        }
        
        function debounce(func, timeout = 300) {
          let timer;
          return (...args) => {
            clearTimeout(timer);
            timer = setTimeout(() => { func.apply(this, args); }, timeout);
          };
        }
        
        // --- ÙˆØ¸ÙŠÙØ© ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© (Standalone) ---
        function generateFinalHTML(data) {
            const safeName = escapeHtml(data.profile.name);
            const safeBio = escapeHtml(data.profile.bio);
            const safeAvatar = escapeHtml(data.profile.avatar);
            const theme = data.design.theme;
            const lang = data.lang;
            const fontName = themes[theme]?.font || 'Cairo'; 
            
            let socialHTML = '';
            for (const [key, val] of Object.entries(data.socials)) {
                if (val && svgs[key]) {
                     let href = val;
                    if (key === 'whatsapp') {
                        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø±Ø§Ø¨Ø· ÙˆØ§ØªØ³Ø§Ø¨
                        href = `https://wa.me/${val.replace(/[^0-9]/g, '')}`;
                    } else if (key === 'twitter' || key === 'instagram' || key === 'facebook' || key === 'linkedin') {
                        // Ø¥Ø¶Ø§ÙØ© http Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
                         if (!val.startsWith('http')) href = `https://${key}.com/${val}`;
                    }
                    socialHTML += `<a href="${escapeHtml(href)}" target="_blank" class="social-icon">${svgs[key]}</a>`;
                }
            }
            
            const avatarDisplay = (theme === 'simple-pro' || data.profile.hideName) ? 'display: none;' : '';
            const avatarMargin = (theme === 'simple-pro' || data.profile.hideName) ? '' : `<img src="${safeAvatar}" alt="${safeName}" class="avatar">`;

            let nameHTML = data.profile.hideName ? '' : `<h1 class="name">${safeName}</h1>`;
            let bioHTML = data.profile.hideBio ? '' : `<p class="bio">${safeBio}</p>`;

            let linksHTML = data.links.map(link => {
                 let linkBg = data.design.linkBgColor;
                 let linkTxt = data.design.linkTextColor;
                 let borderStyle = '';
                 let extraClass = '';
                 
                 // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…Ø®ØªÙ„ÙØ© Ù„Ù„Ø²Ø±
                 if (link.highlight) {
                     linkBg = data.design.textColor;
                     linkTxt = data.design.linkBgColor;
                     borderStyle += `border: 3px solid ${data.design.textColor};`;
                     extraClass += ' highlight-btn';
                 } else if (data.design.btnRadius === 'neubrutalism') {
                        borderStyle += `border: 2px solid ${data.design.textColor}; box-shadow: 4px 4px 0 ${data.design.textColor}; border-radius: 0;`;
                 } else {
                        borderStyle += `border-radius: ${data.design.btnRadius}; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: none;`;
                 }
                
                return `<a href="${escapeHtml(link.url)}" target="_blank" class="link-btn${extraClass}" style="background-color:${linkBg}; color:${linkTxt}; ${borderStyle}">${escapeHtml(link.title)}</a>`;
            }).join('');
            
            let motionProCSS = '';
            if (theme === 'motion-pro') {
                motionProCSS = `
                    .link-btn { transition: transform 0.3s, filter 0.3s, box-shadow 0.3s; }
                    .link-btn:hover {
                        transform: translateY(-5px) scale(1.02);
                        filter: brightness(1.1);
                        box-shadow: 0 8px 15px rgba(0,0,0,0.2) !important;
                    }
                    .social-icon:hover {
                        transform: scale(1.3) rotate(5deg);
                    }
                `;
            }
            
            return `<!DOCTYPE html>
<html lang="${lang}" dir="${lang === 'ar' ? 'rtl' : 'ltr'}">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>${safeName} | Links</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Poppins:wght@400;700;900&family=${fontName.replace(' ', '+')}:wght@400;700;900&display=swap" rel="stylesheet">
<style>
    body { font-family: '${fontName}', sans-serif; margin: 0; padding: 40px 20px; min-height: 100vh; background: ${data.design.bgColor}; color: ${data.design.textColor}; display: flex; flex-direction: column; align-items: center; box-sizing: border-box; }
    .container { width: 100%; max-width: 600px; text-align: center; }
    .avatar { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 4px solid #fff; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 15px; ${avatarDisplay} }
    .name { font-size: 26px; font-weight: 900; margin: 0 0 10px; }
    .bio { font-size: 16px; opacity: 0.9; margin-bottom: 30px; line-height: 1.6; }
    .socials { display: flex; justify-content: center; gap: 18px; margin-bottom: 30px; color: inherit; }
    .social-icon { color: inherit; transition: transform 0.3s ease; display: inline-block; }
    /* ØªØ£ÙƒØ¯Ù†Ø§ Ù‡Ù†Ø§ Ù…Ù† Ø¹Ù…Ù„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ */
    .social-icon svg { width: 24px; height: 24px; vertical-align: middle; }
    .social-icon:hover { transform: scale(1.15); }
    .link-btn { display: block; width: 100%; padding: 18px; margin-bottom: 15px; text-decoration: none; font-weight: 700; font-size: 18px; box-sizing: border-box; transition: filter 0.3s; }
    .link-btn:hover { filter: brightness(0.95); }
    ${motionProCSS}
</style>
</head>
<body>
    <div class="container">
        ${avatarMargin}
        ${nameHTML}
        ${bioHTML}
        <div class="socials">${socialHTML}</div>
        <div class="links">${linksHTML}</div>
    </div>
</body>
</html>`;
        }

    document.addEventListener('DOMContentLoaded', () => {

        // --- 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØªØµØ­ÙŠØ­ Ù…Ø´ÙƒÙ„Ø© ÙÙƒ Ø§Ù„Ø¶ØºØ· ---
        if (window.location.hash && window.location.hash.startsWith('#data=')) {
            try {
                const encodedData = window.location.hash.substring(6);
                
                // Ø­Ø§ÙˆÙ„ ÙÙƒ Ø§Ù„Ø¶ØºØ· (Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ§Ù„ÙØ© Ù…Ù† Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø³Ø§Ø¨Ù‚Ø©)
                let decompressedData;
                try {
                    decompressedData = LZString.decompressFromEncodedURIComponent(encodedData);
                } catch (e) {
                    console.error("LZString Decompression Failed:", e);
                    throw new Error("Failed to decompress data.");
                }

                if (!decompressedData) throw new Error("Decompressed data is empty.");

                const decodedData = JSON.parse(decompressedData);
                
                document.body.classList.add('render-mode');
                document.getElementById('render-container').innerHTML = generateFinalHTML(decodedData);
                document.title = `${escapeHtml(decodedData.profile.name)} | ØµÙØ­Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·`;
            } catch (error) {
                console.error("Data loading failed. Reverting to editor.", error);
                
                // Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ØŒ Ù„Ø§ ØªØ­Ø°Ù Ø§Ù„Ù‡Ø§Ø´ ÙÙˆØ±Ø§Ù‹ØŒ Ø¨Ù„ Ø­Ø§ÙˆÙ„ Ø§Ù„Ø¨Ø¯Ø¡ ÙƒØ§Ù„Ù…Ø¹ØªØ§Ø¯
                initializeApp();
                
                // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                const t = translations[config.lang || 'ar'];
                showToast(t['toast-data-error'] || "Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©. Ù‚Ø¯ ØªÙƒÙˆÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ§Ù„ÙØ©.");
            }
        } else {
            initializeApp();
        }

    });
        
    // (Ø¨Ù‚ÙŠØ© ÙˆØ¸ÙŠÙØ© initializeApp ÙˆØ§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ)
    function initializeApp() {
        const els = {
            name: document.getElementById('profile-name'),
            bio: document.getElementById('profile-bio'),
            hideName: document.getElementById('hide-name-check'),
            hideBio: document.getElementById('hide-bio-check'),
            avatarUpload: document.getElementById('profile-avatar-upload'),
            avatarUrlInput: document.getElementById('profile-avatar-url'), 
            avatarBtnText: document.getElementById('upload-btn-text'),
            deleteAvatarBtn: document.getElementById('delete-avatar-btn'), 
            linksList: document.getElementById('links-list'),
            socialsList: document.getElementById('social-links-list'),
            preview: document.getElementById('preview-content'),
            theme: document.getElementById('theme-selector'),
            colors: {
                bg: document.getElementById('bg-color'),
                linkBg: document.getElementById('link-bg-color'),
                linkText: document.getElementById('link-text-color'),
                text: document.getElementById('text-color')
            },
            btnStyle: document.getElementById('button-style-selector'),
            addLink: document.getElementById('add-link-btn'),
            generate: document.getElementById('generate-link-btn'),
            shorten: document.getElementById('shorten-btn'), 
            download: document.getElementById('download-html-btn'),
            copyHtml: document.getElementById('copy-html-btn'), 
            savedStatus: document.getElementById('saved-status'), 
            langToggleBtn: document.getElementById('lang-toggle-btn'), 
            modal: {
                self: document.getElementById('modal'),
                input: document.getElementById('generated-link'),
                copy: document.getElementById('copy-link-btn'),
                close: document.getElementById('close-modal-btn'),
                qr: document.getElementById('qrcode-container')
            },
            htmlModal: {
                self: document.getElementById('html-modal'),
                codeArea: document.getElementById('final-html-code'),
                copy: document.getElementById('copy-code-btn'),
                close: document.getElementById('close-html-modal-btn')
            }
        };

        const DEFAULTS = { 
            avatar: 'https://cdn-icons-png.flaticon.com/512/847/847969.png',
            name_ar: 'Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§',
            bio_ar: 'Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØµÙØ­ØªÙŠ Ø§Ù„Ø´Ø®ØµÙŠØ© ğŸ‘‹',
            name_en: 'Your Name Here',
            bio_en: 'Welcome to my personal page ğŸ‘‹',
            linkTitle_ar: 'Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯',
            linkTitle_en: 'New Link',
            theme: 'light'
        };

        let config = {
            profile: { 
                name: DEFAULTS.name_ar, 
                bio: DEFAULTS.bio_ar, 
                avatar: DEFAULTS.avatar,
                hideName: false, 
                hideBio: false,  
            },
            socials: { twitter: '', instagram: '', facebook: '', linkedin: '', whatsapp: '' },
            links: [ { title: DEFAULTS.linkTitle_ar, url: 'https://google.com', highlight: false } ], 
            design: { theme: 'light', bgColor: '#f7f8fa', linkBgColor: '#ffffff', linkTextColor: '#1a1a1a', textColor: '#1a1a1a', btnRadius: '8px' },
            lang: 'ar' 
        };
        
        loadConfig();
        
        const translations = {
            ar: { 
                'editor-title': 'Ù…ÙÙ†Ø´Ø¦ ØµÙØ­Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø°ÙƒÙŠØ© - Pro',
                'editor-panel-h1': 'Ù…Ø­Ø±Ø± Ø§Ù„ØµÙØ­Ø©',
                'section-personal': 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©',
                'section-social': 'Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ',
                'section-links': 'Ø§Ù„Ø±ÙˆØ§Ø¨Ø· (Ø§Ø³Ø­Ø¨ Ù„Ù„ØªØ±ØªÙŠØ¨)',
                'section-design': 'Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù†',
                'label-name': 'Ø§Ù„Ø§Ø³Ù…',
                'placeholder-name': 'Ø§Ø³Ù…Ùƒ Ø£Ùˆ Ø¹Ù„Ø§Ù…ØªÙƒ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©',
                'label-bio': 'Ù†Ø¨Ø°Ø© (Bio)',
                'placeholder-bio': 'ÙˆØµÙ Ù…Ø®ØªØµØ±...',
                'label-avatar': 'Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ©',
                'placeholder-avatar-url': 'Ø£Ùˆ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (Ù„ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·)',
                'text-or': '--- Ø£Ùˆ ---',
                'btn-upload-file': 'Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ ğŸ“ (Ù‚Ø¯ ÙŠØ·ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·)',
                'btn-delete-avatar': 'Ø­Ø°Ù Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ©',
                'check-hide-name': 'Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ø³Ù…',
                'check-hide-bio': 'Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ø¨Ø°Ø©',
                'btn-add-link': 'Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯ â•',
                'label-theme': 'Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ø¬Ø§Ù‡Ø²',
                'opt-light': 'ÙØ§ØªØ­ (Light)',
                'opt-dark': 'Ø¯Ø§ÙƒÙ† (Dark)',
                'opt-simple-pro': 'â­ï¸ Ø§Ø­ØªØ±Ø§ÙÙŠ (Ù†ØµÙŠ)',
                'opt-motion-pro': 'âœ¨ Ù…Ù…ÙŠØ² (Ø­Ø±ÙƒÙŠ)',
                'opt-blue': 'Ø£Ø²Ø±Ù‚ Ù…Ø­ÙŠØ·ÙŠ',
                'opt-pink': 'ØªØ¯Ø±Ø¬ ÙˆØ±Ø¯ÙŠ',
                'opt-elegant': 'Ø£Ø³ÙˆØ¯ ÙˆØ°Ù‡Ø¨ÙŠ',
                'opt-custom': 'Ù…Ø®ØµØµ',
                'label-colors': 'ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ù„ÙˆØ§Ù†',
                'title-bg-color': 'Ø§Ù„Ø®Ù„ÙÙŠØ©',
                'title-link-bg-color': 'Ø®Ù„ÙÙŠØ© Ø§Ù„Ø²Ø±',
                'title-link-text-color': 'Ù†Øµ Ø§Ù„Ø²Ø±',
                'title-text-color': 'Ø§Ù„Ù†Øµ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ',
                'label-button-style': 'Ø´ÙƒÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±',
                'opt-soft-edges': 'Ø­ÙˆØ§Ù Ù†Ø§Ø¹Ù…Ø©',
                'opt-full-round': 'Ø¯Ø§Ø¦Ø±ÙŠ ÙƒØ§Ù…Ù„',
                'opt-sharp-square': 'Ù…Ø±Ø¨Ø¹ Ø­Ø§Ø¯',
                'opt-neubrutalism': 'ØªØµÙ…ÙŠÙ… Ø­Ø§Ø¯ (Neubrutalism)',
                'btn-share': 'Ø­ÙØ¸ ÙˆÙ…Ø´Ø§Ø±ÙƒØ©',
                'btn-shorten': 'ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·',
                'btn-download-html': 'ØªØ­Ù…ÙŠÙ„ HTML',
                'btn-copy-html': 'Ù†Ø³Ø® ÙƒÙˆØ¯ HTML',
                'notice-long-url': 'ÙŠÙÙ†ØµØ­ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… "Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ù…Ø¨Ø§Ø´Ø±" Ù„ØªÙ…ÙƒÙŠÙ† Ø®Ø§ØµÙŠØ© ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·.',
                'modal-ready-h2': 'âœ¨ ØµÙØ­ØªÙƒ Ø¬Ø§Ù‡Ø²Ø©!',
                'modal-ready-p': 'Ø§Ù…Ø³Ø­ Ø§Ù„ÙƒÙˆØ¯ Ø£Ùˆ Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ø¯Ù†Ø§Ù‡:',
                'btn-copy-link': 'Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·',
                'btn-close': 'Ø¥ØºÙ„Ø§Ù‚',
                'notice-long-link': '(Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¸Ø§Ù‡Ø± Ø·ÙˆÙŠÙ„Ø§Ù‹ØŒ ÙÙ‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªÙŠ Ø±ÙØ¹ØªÙ‡Ø§ ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹.)',
                'html-modal-h2': 'ğŸ“ ÙƒÙˆØ¯ HTML Ø¬Ø§Ù‡Ø²',
                'html-modal-p': 'Ø§Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ Ø£Ø¯Ù†Ø§Ù‡ ÙˆÙ‚Ù… Ø¨Ø±ÙØ¹Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ Ø§Ø³ØªØ¶Ø§ÙØªÙƒ:',
                'btn-copy-code': 'Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„',
                'link-highlight': 'Ø±Ø§Ø¨Ø· Ø±Ø¦ÙŠØ³ÙŠ',
                'toast-success': 'ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­',
                'toast-copy-link': 'ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰',
                'toast-copy-html': 'ØªÙ… Ù†Ø³Ø® ÙƒÙˆØ¯ HTML Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰',
                'toast-shorten-success': 'ØªÙ… ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰',
                'toast-download': 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù... ğŸ“¥',
                'save-status': 'ØªÙ… Ø§Ù„Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ (Ù…Ø­Ù„ÙŠÙ‹Ø§)',
                'link-new-title': 'Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯',
            },
            en: {
                'editor-title': 'Smart Link Page Builder - Pro',
                'editor-panel-h1': 'Page Editor',
                'section-personal': 'Personal Info',
                'section-social': 'Social Links',
                'section-links': 'Links (Drag to reorder)',
                'section-design': 'Design & Colors',
                'label-name': 'Name',
                'placeholder-name': 'Your Name or Brand',
                'label-bio': 'Bio',
                'placeholder-bio': 'Short description...',
                'label-avatar': 'Avatar Image',
                'placeholder-avatar-url': 'Or Direct Image URL (for shortening)',
                'text-or': '--- OR ---',
                'btn-upload-file': 'Choose image from device ğŸ“ (May result in a long URL)',
                'btn-delete-avatar': 'Delete Avatar',
                'check-hide-name': 'Hide Name',
                'check-hide-bio': 'Hide Bio',
                'btn-add-link': 'Add New Link â•',
                'label-theme': 'Predefined Theme',
                'opt-light': 'Light',
                'opt-dark': 'Dark',
                'opt-simple-pro': 'â­ï¸ Simple Pro (Textual)',
                'opt-motion-pro': 'âœ¨ Motion Pro (Dynamic)',
                'opt-blue': 'Ocean Blue',
                'opt-pink': 'Pink Gradient',
                'opt-elegant': 'Black & Gold',
                'opt-custom': 'Custom',
                'label-colors': 'Customize Colors',
                'title-bg-color': 'Background',
                'title-link-bg-color': 'Button Background',
                'title-link-text-color': 'Button Text',
                'title-text-color': 'Main Text',
                'label-button-style': 'Button Style',
                'opt-soft-edges': 'Soft Edges',
                'opt-full-round': 'Full Round',
                'opt-sharp-square': 'Sharp Square',
                'opt-neubrutalism': 'Neubrutalism',
                'btn-share': 'Save & Share',
                'btn-shorten': 'Shorten Link',
                'btn-download-html': 'Download HTML',
                'btn-copy-html': 'Copy HTML Code',
                'notice-long-url': 'Using a direct image URL is recommended to enable link shortening.',
                'modal-ready-h2': 'âœ¨ Your Page is Ready!',
                'modal-ready-p': 'Scan the code or copy the link below:',
                'btn-copy-link': 'Copy Link',
                'btn-close': 'Close',
                'notice-long-link': '(If the link appears very long, the image you uploaded is too large.)',
                'html-modal-h2': 'ğŸ“ Ready HTML Code',
                'html-modal-p': 'Copy the code below and upload it directly to your hosting:',
                'btn-copy-code': 'Copy Full Code',
                'link-highlight': 'Highlight Link',
                'toast-success': 'Operation successful',
                'toast-copy-link': 'Link copied successfully! ğŸ‰',
                'toast-copy-html': 'HTML code copied successfully! ğŸ‰',
                'toast-shorten-success': 'Link shortened successfully! ğŸ‰',
                'toast-download': 'Downloading file... ğŸ“¥',
                'save-status': 'Saved automatically (locally)',
                'link-new-title': 'New Link',
            }
        };

        const saveConfigDebounced = debounce(saveConfig);

        function saveConfig() {
            try {
                localStorage.setItem('linkPageConfig', JSON.stringify(config));
                els.savedStatus.textContent = translations[config.lang]['save-status'];
                setTimeout(() => { els.savedStatus.textContent = ''; }, 2000);
            } catch (e) {
                console.error("Local storage error:", e);
            }
        }
        
        function loadConfig() {
            try {
                const savedConfig = localStorage.getItem('linkPageConfig');
                if (savedConfig) {
                    const loadedConfig = JSON.parse(savedConfig);
                    config = { ...config, ...loadedConfig };
                    
                    if (!Array.isArray(config.links)) config.links = [ { title: DEFAULTS.linkTitle_ar, url: 'https://google.com', highlight: false } ];
                    if (typeof config.socials !== 'object') config.socials = { twitter: '', instagram: '', facebook: '', linkedin: '', whatsapp: '' };
                }
            } catch (e) {
                console.warn("Failed to load config from storage:", e);
                localStorage.removeItem('linkPageConfig');
            }
        }

        function setLanguage(lang) {
            config.lang = lang;
            const t = translations[lang];
            
            document.documentElement.lang = lang;
            document.documentElement.dir = (lang === 'ar' ? 'rtl' : 'ltr');
            document.body.classList.toggle('en-mode', lang === 'en');
            
            document.title = t['editor-title'];
            document.getElementById('editor-h1').innerHTML = `ğŸ› ï¸ ${t['editor-panel-h1']}`;
            els.langToggleBtn.textContent = (lang === 'ar' ? 'English ğŸ‡ºğŸ‡¸' : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ğŸ‡¦ğŸ‡ª');
            
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[key]) el.textContent = t[key];
            });
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (t[key]) el.placeholder = t[key];
            });
             document.querySelectorAll('[data-i18n-title]').forEach(el => {
                const key = el.getAttribute('data-i18n-title');
                if (t[key]) el.title = t[key];
            });
            
            syncUI();
            saveConfig();
        }

        function renderPreview() {
            els.preview.style.background = config.design.bgColor;
            els.preview.style.color = config.design.textColor;

            const isSimplePro = config.design.theme === 'simple-pro';
            
            const avatarHtml = (isSimplePro || config.profile.hideName) 
                ? '' 
                : `<img src="${escapeHtml(config.profile.avatar)}" style="width:100px; height:100px; border-radius:50%; object-fit:cover; border:3px solid #fff; box-shadow:0 5px 15px rgba(0,0,0,0.1); margin-bottom:10px;">`;

            let html = `${avatarHtml}`;
            
            if (!config.profile.hideName) {
                 html += `<h2 style="margin:5px 0 10px; font-weight:900;">${escapeHtml(config.profile.name)}</h2>`;
            }
            if (!config.profile.hideBio) {
                 html += `<p style="margin:0 auto 20px; opacity:0.9; max-width:90%; font-size:14px; line-height:1.5;">${escapeHtml(config.profile.bio)}</p>`;
            }


            let socialPreviewHTML = '';
            socialPreviewHTML += '<div style="display:flex; justify-content:center; gap:15px; margin-bottom:30px;">';
            for (const [key, val] of Object.entries(config.socials)) {
                if (val && svgs[key]) {
                    let href = val;
                    if (key === 'whatsapp') {
                        href = `https://wa.me/${val.replace(/[^0-9]/g, '')}`;
                    } else if (key === 'twitter' || key === 'instagram' || key === 'facebook' || key === 'linkedin') {
                         if (!val.startsWith('http')) href = `https://${key}.com/${val}`;
                    }
                    socialPreviewHTML += `<a href="${escapeHtml(href)}" target="_blank" style="color:inherit; transition:transform 0.3s;" onmouseover="this.style.transform='scale(1.15)'" onmouseout="this.style.transform='scale(1)'">${svgs[key]}</a>`;
                }
            }
            socialPreviewHTML += '</div>';
            html += socialPreviewHTML;


            html += '<div style="display:flex; flex-direction:column; gap:15px;">';
            config.links.forEach(link => {
                let borderStyle = '';
                let extraStyles = '';
                
                if (link.highlight) {
                    borderStyle += ` border: 3px solid ${config.design.textColor}; `;
                    extraStyles += ` background-color: ${config.design.textColor}; color: ${config.design.linkBgColor}; `;
                } else if (config.design.btnRadius === 'neubrutalism') {
                    borderStyle += `border: 2px solid ${config.design.textColor}; box-shadow: 4px 4px 0 ${config.design.textColor}; border-radius: 0;`;
                } else {
                    borderStyle += `border-radius: ${config.design.btnRadius}; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: none;`;
                }
                
                if (config.design.theme === 'motion-pro') {
                    extraStyles += 'filter: brightness(0.98);'; 
                }

                html += `
                    <a href="${escapeHtml(link.url)}" target="_blank" style="
                        background-color: ${link.highlight ? config.design.textColor : config.design.linkBgColor};
                        color: ${link.highlight ? config.design.linkBgColor : config.design.linkTextColor};
                        padding: 16px;
                        text-decoration: none;
                        font-weight: bold;
                        display: block;
                        width: 90%;
                        margin: 0 auto;
                        transition: all 0.2s;
                        ${borderStyle}
                        ${extraStyles}
                    ">${escapeHtml(link.title)}</a>
                `;
            });
            html += '</div>';

            els.preview.innerHTML = html;
        }

        function syncUI() {
            els.name.value = config.profile.name;
            els.bio.value = config.profile.bio;
            els.hideName.checked = config.profile.hideName;
            els.hideBio.checked = config.profile.hideBio;
            
            const t = translations[config.lang];
            if (config.profile.avatar.startsWith('data:')) {
                els.avatarUrlInput.value = '';
                els.avatarBtnText.textContent = t['btn-upload-file'].replace('ğŸ“', 'âœ…');
            } else {
                els.avatarUrlInput.value = config.profile.avatar;
                els.avatarBtnText.textContent = t['btn-upload-file'];
            }
            
            els.deleteAvatarBtn.style.display = (config.profile.avatar !== DEFAULTS.avatar) ? 'flex' : 'none';

            els.socialsList.innerHTML = '';
            Object.keys(config.socials).forEach(key => {
                const div = document.createElement('div');
                div.className = 'form-group';
                div.innerHTML = `<label style="text-transform:capitalize">${key}</label><input type="text" data-social="${key}" value="${escapeHtml(config.socials[key])}" placeholder="${key === 'whatsapp' ? 'ex: 201xxxxxxx' : 'username / url'}">`;
                els.socialsList.appendChild(div);
            });

            renderLinksList();

            els.colors.bg.value = config.design.bgColor.startsWith('#') ? config.design.bgColor : '#ffffff';
            els.colors.linkBg.value = config.design.linkBgColor.startsWith('rgb') ? '#ffffff' : config.design.linkBgColor;
            els.colors.linkText.value = config.design.linkTextColor.startsWith('rgb') ? '#1a1a1a' : config.design.linkTextColor;
            els.colors.text.value = config.design.textColor;
            els.theme.value = config.design.theme;
            els.btnStyle.value = config.design.btnRadius;

            renderPreview();
        }

        function renderLinksList() {
            const t = translations[config.lang];
            els.linksList.innerHTML = '';
            config.links.forEach((link, idx) => {
                const div = document.createElement('div');
                div.className = 'link-item';
                div.setAttribute('data-id', idx);
                div.innerHTML = `
                    <span class="drag-handle">â˜°</span>
                    <div style="flex:1;">
                        <input type="text" class="link-title" value="${escapeHtml(link.title)}" placeholder="${t['link-new-title']}" style="margin-bottom:5px;">
                        <input type="url" class="link-url" value="${escapeHtml(link.url)}" placeholder="URL (https://...)">
                        <div class="link-options">
                            <label>
                                <input type="checkbox" class="link-highlight" ${link.highlight ? 'checked' : ''}> 
                                <span data-i18n="link-highlight">${t['link-highlight']}</span>
                            </label>
                        </div>
                    </div>
                    <button class="btn btn-danger delete-btn">ğŸ—‘ï¸</button>
                `;
                els.linksList.appendChild(div);
            });
        }

        // --- Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„Ø£Ø­Ø¯Ø§Ø« (Event Listeners) ---
        
        [els.name, els.bio, els.hideName, els.hideBio].forEach(el => el.addEventListener('input', () => {
            config.profile.name = els.name.value;
            config.profile.bio = els.bio.value;
            config.profile.hideName = els.hideName.checked;
            config.profile.hideBio = els.hideBio.checked;
            renderPreview();
            saveConfigDebounced();
        }));
        
        els.avatarUrlInput.addEventListener('input', () => {
            config.profile.avatar = els.avatarUrlInput.value || DEFAULTS.avatar;
            els.avatarUpload.value = '';
            syncUI();
            saveConfigDebounced();
        });

        els.avatarUpload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                if (file.size > 500 * 1024) { 
                    alert(translations[config.lang]['alert-large-image'] || 'âš ï¸ Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹. ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø£Ù‚Ù„ Ù…Ù† 500 ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø±Ø§Ø¨Ø· Ø®Ø§Ø±Ø¬ÙŠ.');
                    e.target.value = '';
                    return;
                }
                const reader = new FileReader();
                reader.onload = function(event) {
                    config.profile.avatar = event.target.result;
                    syncUI();
                    saveConfigDebounced();
                };
                reader.readAsDataURL(file);
            }
        });
        
        els.deleteAvatarBtn.addEventListener('click', () => {
            config.profile.avatar = DEFAULTS.avatar; 
            els.avatarUpload.value = ''; 
            syncUI(); 
            showToast(translations[config.lang]['toast-delete-avatar'] || "ØªÙ… Ø­Ø°Ù Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­.");
            saveConfig();
        });

        els.socialsList.addEventListener('input', (e) => {
            if(e.target.tagName === 'INPUT') {
                config.socials[e.target.dataset.social] = e.target.value;
                renderPreview();
                saveConfigDebounced();
            }
        });

        els.addLink.addEventListener('click', () => {
            config.links.push({ title: translations[config.lang]['link-new-title'], url: '#', highlight: false });
            syncUI();
            saveConfig();
        });

        els.linksList.addEventListener('input', (e) => {
            const itemEl = e.target.closest('.link-item');
            if (!itemEl) return;
            const idx = itemEl.dataset.id;
            
            if(e.target.classList.contains('link-title')) config.links[idx].title = e.target.value;
            if(e.target.classList.contains('link-url')) config.links[idx].url = e.target.value;
            
            renderPreview();
            saveConfigDebounced();
        });
        
        els.linksList.addEventListener('change', (e) => {
            if(e.target.classList.contains('link-highlight')) {
                const idx = e.target.closest('.link-item').dataset.id;
                config.links[idx].highlight = e.target.checked;
                renderPreview();
                saveConfigDebounced();
            }
        });

        els.linksList.addEventListener('click', (e) => {
            if(e.target.classList.contains('delete-btn') || e.target.parentElement.classList.contains('delete-btn')) {
                const idx = e.target.closest('.link-item').dataset.id;
                config.links.splice(idx, 1);
                syncUI();
                saveConfig();
            }
        });

        new Sortable(els.linksList, {
            handle: '.drag-handle',
            animation: 150,
            ghostClass: 'sortable-ghost',
            onEnd: function (evt) {
                const item = config.links.splice(evt.oldIndex, 1)[0];
                config.links.splice(evt.newIndex, 0, item);
                syncUI(); 
                saveConfig();
            }
        });

        els.theme.addEventListener('change', (e) => {
            const t = themes[e.target.value];
            if(t) {
                config.design.theme = e.target.value;
                config.design.bgColor = t.bg;
                config.design.linkBgColor = t.lBg;
                config.design.linkTextColor = t.lTxt;
                config.design.textColor = t.txt;
                config.design.btnRadius = t.btnRadius || '8px'; 
                syncUI();
                saveConfig();
            }
        });

        Object.values(els.colors).forEach(input => {
            input.addEventListener('input', () => {
                config.design.bgColor = els.colors.bg.value;
                config.design.linkBgColor = els.colors.linkBg.value;
                config.design.linkTextColor = els.colors.linkText.value;
                config.design.textColor = els.colors.text.value;
                config.design.theme = 'custom'; 
                els.theme.value = 'custom';
                renderPreview();
                saveConfigDebounced();
            });
        });

        els.btnStyle.addEventListener('change', (e) => {
            config.design.btnRadius = e.target.value;
            renderPreview();
            saveConfigDebounced();
        });
        
        els.langToggleBtn.addEventListener('click', () => {
            setLanguage(config.lang === 'ar' ? 'en' : 'ar');
        });

        // --- Ø§Ù„Ø­ÙØ¸ ÙˆØ§Ù„ØªØµØ¯ÙŠØ± ---
        
        function getLongUrl() {
            const jsonString = JSON.stringify(config);
            const compressed = LZString.compressToEncodedURIComponent(jsonString);
            // ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… window.location.origin Ùˆ window.location.pathname Ù„Ø¶Ù…Ø§Ù† Ø¹Ù…Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ø£ÙŠ Ù…Ø³Ø§Ø± Ù…Ù„Ù
            return `${window.location.origin}${window.location.pathname}#data=${compressed}`;
        }

        els.generate.addEventListener('click', () => {
            const url = getLongUrl();
            
            els.modal.input.value = url;
            
            els.modal.qr.innerHTML = ''; 
            try {
                new QRCode(els.modal.qr, { text: url, width: 128, height: 128, correctLevel : QRCode.CorrectLevel.H });
            } catch (e) {
                 els.modal.qr.innerHTML = `<p style="color:red; font-weight:bold;">${translations[config.lang]['notice-qr-too-long'] || 'Ø§Ù„Ø±Ø§Ø¨Ø· Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªÙˆÙ„ÙŠØ¯ QR Code.'}</p>`;
            }

            els.modal.self.style.display = 'flex';
        });
        
        els.shorten.addEventListener('click', async () => {
            const longUrl = getLongUrl();
            const t = translations[config.lang];

            if (longUrl.length > 2000) {
                alert(t['alert-shorten-fail'] || 'âš ï¸ Ø§Ù„Ø±Ø§Ø¨Ø· Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹. Ù„Ù† ØªØªÙ…ÙƒÙ† Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªÙ‚ØµÙŠØ± Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© Ù…Ù† Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡. ØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø·ÙˆÙŠÙ„ ÙƒØ¨Ø¯ÙŠÙ„.');
                els.generate.click(); 
                return;
            }

            const originalText = els.shorten.querySelector('span').textContent;
            els.shorten.querySelector('span').textContent = t['btn-shortening'] || "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ‚ØµÙŠØ±...";
            els.shorten.disabled = true;

            try {
                const response = await fetch(`https://tinyurl.com/api-create.php?url=${encodeURIComponent(longUrl)}`);
                
                if (response.ok) {
                    const shortUrl = await response.text();
                    
                    els.modal.input.value = shortUrl;
                    els.modal.qr.innerHTML = '';
                    new QRCode(els.modal.qr, { text: shortUrl, width: 128, height: 128 });

                    els.modal.self.style.display = 'flex';
                    showToast(t['toast-shorten-success']);
                } else {
                    throw new Error('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø©');
                }
            } catch (error) {
                console.error(error);
                alert(t['alert-shorten-error'] || "Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·. ØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø·ÙˆÙŠÙ„ ÙƒØ¨Ø¯ÙŠÙ„.");
                els.generate.click(); 
            } finally {
                els.shorten.querySelector('span').textContent = originalText;
                els.shorten.disabled = false;
            }
        });


        els.modal.copy.addEventListener('click', () => {
            els.modal.input.select();
            document.execCommand('copy');
            showToast(translations[config.lang]['toast-copy-link']);
        });

        els.modal.close.addEventListener('click', () => {
            els.modal.self.style.display = 'none';
        });

        // ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù HTML Ø«Ø§Ø¨Øª
        els.download.addEventListener('click', () => {
            const finalHTML = generateFinalHTML(config);
            const blob = new Blob([finalHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `index-${Date.now()}.html`;
            a.click();
            URL.revokeObjectURL(url);
            showToast(translations[config.lang]['toast-download']);
        });
        
        // Ù†Ø³Ø® ÙƒÙˆØ¯ HTML
        els.copyHtml.addEventListener('click', () => {
            const finalHTML = generateFinalHTML(config);
            els.htmlModal.codeArea.value = finalHTML;
            els.htmlModal.self.style.display = 'flex';
        });
        
        els.htmlModal.copy.addEventListener('click', () => {
            els.htmlModal.codeArea.select();
            document.execCommand('copy');
            showToast(translations[config.lang]['toast-copy-html']);
        });
        
        els.htmlModal.close.addEventListener('click', () => {
            els.htmlModal.self.style.display = 'none';
        });

        setLanguage(config.lang);
        syncUI();
    }
    </script>
</body>
</html>