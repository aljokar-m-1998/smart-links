<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙÙ†Ø´Ø¦ ØµÙØ­Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø°ÙƒÙŠØ© - Pro</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Almarai:wght@400;700&family=Cairo:wght@400;700;900&family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        /* --- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© --- */
        :root {
            --editor-bg: #f7f8fa;
            --preview-bg: #eef0f5;
            --widget-bg: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #555;
            --border-color: #e0e0e0;
            --accent-color: #007bff;
            --accent-hover: #0056b3;
            --danger-color: #dc3545;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --border-radius: 12px;
        }

        body {
            font-family: 'Cairo', sans-serif;
            margin: 0;
            background-color: var(--editor-bg);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            display: flex;
        }

        /* --- Ø§Ù„ØªØ®Ø·ÙŠØ· Ø§Ù„Ø¹Ø§Ù… --- */
        #app-container { display: flex; width: 100%; height: 100%; }

        /* --- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (ÙŠÙ…ÙŠÙ†) --- */
        #editor-panel {
            width: 450px;
            height: 100%;
            overflow-y: auto;
            background-color: var(--widget-bg);
            padding: 25px;
            border-left: 1px solid var(--border-color);
            box-shadow: -5px 0 15px rgba(0,0,0,0.05);
            box-sizing: border-box;
        }

        #editor-panel h1 {
            font-size: 24px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;
        }

        /* --- Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© (ÙŠØ³Ø§Ø±) --- */
        #preview-panel {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--preview-bg);
            padding: 20px;
            height: 100%;
            overflow: hidden;
        }

        /* --- Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ --- */
        .editor-section {
            background: var(--editor-bg);
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }
        
        .editor-section summary {
            font-weight: 700; padding: 15px; cursor: pointer; list-style: none;
            display: flex; justify-content: space-between; align-items: center; background: #fff;
        }
        .editor-section summary::-webkit-details-marker { display: none; }
        
        .form-content { padding: 15px; border-top: 1px solid var(--border-color); }
        
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-size: 14px; font-weight: 700; margin-bottom: 8px; color: var(--text-secondary); }
        
        input[type="text"], input[type="url"], textarea, select {
            width: 100%; padding: 10px; border: 1px solid var(--border-color);
            border-radius: 8px; background: #fff; box-sizing: border-box; transition: 0.2s;
            font-family: inherit;
        }
        input:focus, textarea:focus { outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 2px rgba(0,123,255,0.2); }

        /* --- Ø²Ø± Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© ÙˆØªØ¹Ø¯ÙŠÙ„ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© --- */
        .file-upload-wrapper {
            position: relative; overflow: hidden; display: inline-block; width: 100%;
            margin-bottom: 10px;
        }
        .file-upload-wrapper input[type=file] {
            font-size: 100px; position: absolute; left: 0; top: 0; opacity: 0; cursor: pointer;
        }
        .file-upload-btn {
            border: 1px dashed var(--accent-color); color: var(--accent-color);
            background: rgba(0,123,255,0.05); padding: 10px; text-align: center;
            border-radius: 8px; font-weight: 700; cursor: pointer;
        }
        #profile-avatar-url { margin-top: 10px; }

        /* --- Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† --- */
        .color-picker-group { display: flex; gap: 10px; }
        input[type="color"] { -webkit-appearance: none; width: 40px; height: 40px; border: none; padding: 0; border-radius: 50%; cursor: pointer; }
        
        .btn {
            padding: 10px 18px; border: none; border-radius: 8px; cursor: pointer;
            font-weight: 700; transition: all 0.2s; display: inline-flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-primary { background-color: var(--accent-color); color: white; }
        .btn-primary:hover { background-color: var(--accent-hover); }
        .btn-secondary { background-color: #6c757d; color: white; }
        .btn-danger { background: transparent; color: var(--danger-color); }
        .btn-danger:hover { background-color: rgba(220, 53, 69, 0.1); }
        .btn-success { background-color: #28a745; color: white; }
        .btn-success:hover { background-color: #1e7e34; }
        .btn-full { width: 100%; }

        /* --- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· --- */
        #links-list .link-item {
            background-color: #fff; padding: 10px; border: 1px solid var(--border-color);
            border-radius: 8px; margin-bottom: 10px; display: flex; align-items: center; gap: 10px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .drag-handle { cursor: grab; color: #aaa; font-size: 20px; padding: 0 5px; }
        .sortable-ghost { opacity: 0.4; background: #e0f0ff; }

        /* --- Ø§Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© --- */
        #preview-frame {
            width: 375px; height: 812px; background-color: white; border-radius: 40px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.15); padding: 15px; box-sizing: border-box;
            position: relative; border: 8px solid #333;
        }
        #preview-content {
            width: 100%; height: 100%; background-color: #f0f0f0; border-radius: 30px;
            overflow-y: auto; text-align: center; padding: 40px 15px; box-sizing: border-box;
        }
        #preview-content::-webkit-scrollbar { display: none; }

        /* --- Modal --- */
        #modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6);
            display: none; justify-content: center; align-items: center; z-index: 1000;
        }
        #modal-content {
            background: white; padding: 30px; border-radius: var(--border-radius);
            width: 90%; max-width: 450px; text-align: center; animation: slideUp 0.3s ease;
        }
        @keyframes slideUp { from {transform: translateY(20px); opacity: 0;} to {transform: translateY(0); opacity: 1;} }
        #qrcode-container { margin: 20px auto; display: flex; justify-content: center; }
        
        /* --- Toast Notification --- */
        #toast {
            visibility: hidden; min-width: 250px; background-color: #333; color: #fff;
            text-align: center; border-radius: 8px; padding: 16px; position: fixed;
            z-index: 2000; left: 50%; bottom: 30px; transform: translateX(-50%);
            font-size: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

        /* --- ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ --- */
        body.render-mode { display: block; height: auto; overflow: auto; background: #fff; }
        body.render-mode #app-container { display: none; }
        #render-container { display: none; }
        body.render-mode #render-container { display: block; }

        /* --- Ø§Ù„ØªØ¬Ø§ÙˆØ¨ --- */
        @media (max-width: 900px) {
            #app-container { flex-direction: column; }
            #editor-panel { width: 100%; height: auto; border-left: none; }
            #preview-panel { height: 100vh; position: sticky; top: 0; z-index: 10; border-top: 1px solid #ddd;}
            #preview-frame { height: 90%; width: 90%; border-width: 4px; }
        }
    </style>
</head>
<body>

    <div id="toast">ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­</div>

    <div id="app-container">
        <div id="editor-panel">
            <h1>ğŸ› ï¸ Ù…Ø­Ø±Ø± Ø§Ù„ØµÙØ­Ø©</h1>
            
            <details class="editor-section" open>
                <summary>Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</summary>
                <div class="form-content">
                    <div class="form-group">
                        <label>Ø§Ù„Ø§Ø³Ù…</label>
                        <input type="text" id="profile-name" placeholder="Ø§Ø³Ù…Ùƒ Ø£Ùˆ Ø¹Ù„Ø§Ù…ØªÙƒ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©">
                    </div>
                    <div class="form-group">
                        <label>Ù†Ø¨Ø°Ø© (Bio)</label>
                        <textarea id="profile-bio" placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ±..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ù…Ø²ÙŠØ©</label>
                        
                        <input type="url" id="profile-avatar-url" placeholder="Ø£Ùˆ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø± (Ù„ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·)">
                        
                        <p style="text-align: center; margin: 5px 0; font-size: 12px; color: #888;">--- Ø£Ùˆ ---</p>
                        
                        <div class="file-upload-wrapper">
                            <div class="file-upload-btn" id="upload-btn-text">Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ ğŸ“ (Ù‚Ø¯ ÙŠØ·ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·)</div>
                            <input type="file" id="profile-avatar-upload" accept="image/*">
                        </div>
                    </div>
                </div>
            </details>
            
            <details class="editor-section">
                <summary>Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</summary>
                <div class="form-content" id="social-links-list"></div>
            </details>

            <details class="editor-section" open>
                <summary>Ø§Ù„Ø±ÙˆØ§Ø¨Ø· (Ø§Ø³Ø­Ø¨ Ù„Ù„ØªØ±ØªÙŠØ¨)</summary>
                <div class="form-content">
                    <div id="links-list"></div>
                    <button id="add-link-btn" class="btn btn-primary btn-full">
                         Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯ â•
                    </button>
                </div>
            </details>

            <details class="editor-section" open>
                <summary>Ø§Ù„ØªØµÙ…ÙŠÙ… ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù†</summary>
                <div class="form-content">
                     <div class="form-group">
                        <label>Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ø¬Ø§Ù‡Ø²</label>
                        <select id="theme-selector">
                            <option value="light">ÙØ§ØªØ­ (Light)</option>
                            <option value="dark">Ø¯Ø§ÙƒÙ† (Dark)</option>
                            <option value="simple-pro">â­ï¸ Ø§Ø­ØªØ±Ø§ÙÙŠ (Ù†ØµÙŠ)</option>
                            <option value="motion-pro">âœ¨ Ù…Ù…ÙŠØ² (Ø­Ø±ÙƒÙŠ)</option>
                            <option value="blue">Ø£Ø²Ø±Ù‚ Ù…Ø­ÙŠØ·ÙŠ</option>
                            <option value="pink">ØªØ¯Ø±Ø¬ ÙˆØ±Ø¯ÙŠ</option>
                            <option value="elegant">Ø£Ø³ÙˆØ¯ ÙˆØ°Ù‡Ø¨ÙŠ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ù„ÙˆØ§Ù†</label>
                        <div class="color-picker-group">
                            <input type="color" id="bg-color" title="Ø§Ù„Ø®Ù„ÙÙŠØ©">
                            <input type="color" id="link-bg-color" title="Ø®Ù„ÙÙŠØ© Ø§Ù„Ø²Ø±">
                            <input type="color" id="link-text-color" title="Ù†Øµ Ø§Ù„Ø²Ø±">
                            <input type="color" id="text-color" title="Ø§Ù„Ù†Øµ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ø´ÙƒÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±</label>
                        <select id="button-style-selector">
                            <option value="8px">Ø­ÙˆØ§Ù Ù†Ø§Ø¹Ù…Ø©</option>
                            <option value="25px">Ø¯Ø§Ø¦Ø±ÙŠ ÙƒØ§Ù…Ù„</option>
                            <option value="0px">Ù…Ø±Ø¨Ø¹ Ø­Ø§Ø¯</option>
                            <option value="neubrutalism">ØªØµÙ…ÙŠÙ… Ø­Ø§Ø¯ (Neubrutalism)</option>
                        </select>
                    </div>
                </div>
            </details>

            <div class="actions" style="margin-top: 25px; display: flex; gap: 10px; flex-wrap: wrap;">
                <button id="generate-link-btn" class="btn btn-primary" style="flex:1;">Ø­ÙØ¸ ÙˆÙ…Ø´Ø§Ø±ÙƒØ© ğŸš€</button>
                <button id="shorten-btn" class="btn btn-success" style="flex:1;">ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø· âœ‚ï¸</button>
                <button id="download-html-btn" class="btn btn-secondary" style="flex:1;">ØªØ­Ù…ÙŠÙ„ HTML ğŸ’¾</button>
            </div>
            
            <div style="margin-top: 20px; font-size: 12px; color: #888; text-align: center;">
                * ÙŠÙÙ†ØµØ­ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… "Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ù…Ø¨Ø§Ø´Ø±" Ù„ØªÙ…ÙƒÙŠÙ† Ø®Ø§ØµÙŠØ© ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·.
            </div>
        </div>

        <div id="preview-panel">
            <div id="preview-frame">
                <div id="preview-content">
                    </div>
            </div>
        </div>
    </div>

    <div id="render-container"></div>
    
    <div id="modal">
        <div id="modal-content">
            <h2>âœ¨ ØµÙØ­ØªÙƒ Ø¬Ø§Ù‡Ø²Ø©!</h2>
            <p>Ø§Ù…Ø³Ø­ Ø§Ù„ÙƒÙˆØ¯ Ø£Ùˆ Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ø¯Ù†Ø§Ù‡:</p>
            <div id="qrcode-container"></div>
            <input type="text" id="generated-link" readonly style="direction: ltr; text-align: center; margin-bottom: 10px;">
            <div style="display: flex; gap: 10px;">
                <button id="copy-link-btn" class="btn btn-primary" style="flex:1;">Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·</button>
                <button id="close-modal-btn" class="btn btn-secondary" style="flex:1;">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
            <p style="font-size: 12px; margin-top: 15px; color: #555;">(Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¸Ø§Ù‡Ø± Ø·ÙˆÙŠÙ„Ø§Ù‹ØŒ ÙÙ‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªÙŠ Ø±ÙØ¹ØªÙ‡Ø§ ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹.)</p>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·: Ù‡Ù„ Ù†Ø­Ù† ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø£Ù… Ø§Ù„Ø¹Ø±Ø¶ØŸ ---
        if (window.location.hash && window.location.hash.startsWith('#data=')) {
            try {
                const encodedData = window.location.hash.substring(6);
                const decompressedData = LZString.decompressFromEncodedURIComponent(encodedData);
                const decodedData = JSON.parse(decompressedData);
                
                document.body.classList.add('render-mode');
                document.getElementById('render-container').innerHTML = generateFinalHTML(decodedData);
                document.title = `${escapeHtml(decodedData.profile.name)} | ØµÙØ­Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø·`;
            } catch (error) {
                console.error("Data error:", error);
                showToast("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø±Ø§Ø¨Ø·ØŒ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ø­Ø±Ø±...");
                setTimeout(initializeApp, 1500);
            }
        } else {
            initializeApp();
        }

    });

    // --- Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©: ØªØ¹Ù‚ÙŠÙ… Ø§Ù„Ù†ØµÙˆØµ (XSS Protection) ---
    function escapeHtml(text) {
        if (!text) return "";
        return text
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#039;");
    }

    // --- Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©: Ø¹Ø±Ø¶ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª (Toast) ---
    function showToast(message) {
        const x = document.getElementById("toast");
        x.textContent = message;
        x.className = "show";
        setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    }

    function initializeApp() {
        // Ø¹Ù†Ø§ØµØ± DOM
        const els = {
            name: document.getElementById('profile-name'),
            bio: document.getElementById('profile-bio'),
            avatarUpload: document.getElementById('profile-avatar-upload'),
            avatarUrlInput: document.getElementById('profile-avatar-url'), // Ø§Ù„Ø¬Ø¯ÙŠØ¯
            avatarBtnText: document.getElementById('upload-btn-text'),
            linksList: document.getElementById('links-list'),
            socialsList: document.getElementById('social-links-list'),
            preview: document.getElementById('preview-content'),
            theme: document.getElementById('theme-selector'),
            colors: {
                bg: document.getElementById('bg-color'),
                linkBg: document.getElementById('link-bg-color'),
                linkText: document.getElementById('link-text-color'),
                text: document.getElementById('text-color')
            },
            btnStyle: document.getElementById('button-style-selector'),
            addLink: document.getElementById('add-link-btn'),
            generate: document.getElementById('generate-link-btn'),
            shorten: document.getElementById('shorten-btn'), // Ø§Ù„Ø¬Ø¯ÙŠØ¯
            download: document.getElementById('download-html-btn'),
            modal: {
                self: document.getElementById('modal'),
                input: document.getElementById('generated-link'),
                copy: document.getElementById('copy-link-btn'),
                close: document.getElementById('close-modal-btn'),
                qr: document.getElementById('qrcode-container')
            }
        };

        // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        let config = {
            profile: { name: 'Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§', bio: 'Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØµÙØ­ØªÙŠ Ø§Ù„Ø´Ø®ØµÙŠØ© ğŸ‘‹', avatar: 'https://cdn-icons-png.flaticon.com/512/847/847969.png' },
            socials: { twitter: '', instagram: '', facebook: '', linkedin: '', whatsapp: '' },
            links: [ { title: 'Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ğŸŒ', url: 'https://google.com' } ],
            design: { theme: 'light', bgColor: '#f7f8fa', linkBgColor: '#ffffff', linkTextColor: '#1a1a1a', textColor: '#1a1a1a', btnRadius: '8px' }
        };

        // Ø§Ù„Ø«ÙŠÙ…Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙˆØ§Ù„Ù…Ø­Ø¯Ø«Ø©
        const themes = {
            'light': { bg: '#f7f8fa', lBg: '#ffffff', lTxt: '#1a1a1a', txt: '#1a1a1a' },
            'dark': { bg: '#121212', lBg: '#2a2a2a', lTxt: '#ffffff', txt: '#ffffff' },
            // Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ (Ù†ØµÙŠ)
            'simple-pro': { bg: '#f9f9f9', lBg: '#000000', lTxt: '#ffffff', txt: '#333333', btnRadius: '25px' },
            // Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø­Ø±ÙƒÙŠ (Ù…Ù…ÙŠØ²)
            'motion-pro': { bg: 'linear-gradient(180deg, #1e3c72 0%, #2a5298 100%)', lBg: 'rgba(255,255,255,0.95)', lTxt: '#2a5298', txt: '#ffffff', btnRadius: '12px' },
            'blue': { bg: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', lBg: 'rgba(255,255,255,0.9)', lTxt: '#4a4a4a', txt: '#ffffff' },
            'pink': { bg: 'linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%)', lBg: '#fff0f3', lTxt: '#d63384', txt: '#4a001f' },
            'elegant': { bg: '#000000', lBg: '#D4AF37', lTxt: '#000000', txt: '#D4AF37' }
        };

        // Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª SVG (ÙƒÙ…Ø§ Ù‡ÙŠ)
        const icons = {
            twitter: '<svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>',
            instagram: '<svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.85s-.011 3.584-.069 4.85c-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07s-3.584-.012-4.85-.07c-3.252-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.85s.012-3.584.07-4.85c.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.85-.069zM12 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zm0 10.162a3.999 3.999 0 110-7.998 3.999 3.999 0 010 7.998z"/></svg>',
            facebook: '<svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg>',
            linkedin: '<svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452z"/></svg>',
            whatsapp: '<svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>'
        };

        // --- Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© (Core Rendering) ---
        function renderPreview() {
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù„ÙˆØ§Ù†
            els.preview.style.background = config.design.bgColor;
            els.preview.style.color = config.design.textColor;

            const isSimplePro = config.design.theme === 'simple-pro';
            const avatarHtml = isSimplePro 
                ? '' // Ù„Ø§ ØµÙˆØ±Ø© ÙÙŠ Ù‚Ø§Ù„Ø¨ Simple Pro
                : `<img src="${escapeHtml(config.profile.avatar)}" style="width:100px; height:100px; border-radius:50%; object-fit:cover; border:3px solid #fff; box-shadow:0 5px 15px rgba(0,0,0,0.1); margin-bottom:10px;">`;

            // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… escapeHtml Ù„Ù…Ù†Ø¹ XSS)
            let html = `
                ${avatarHtml}
                <h2 style="margin:5px 0 10px; font-weight:900;">${escapeHtml(config.profile.name)}</h2>
                <p style="margin:0 auto 20px; opacity:0.9; max-width:90%; font-size:14px; line-height:1.5;">${escapeHtml(config.profile.bio)}</p>
            `;

            // 2. Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ
            html += '<div style="display:flex; justify-content:center; gap:15px; margin-bottom:25px;">';
            for (const [key, val] of Object.entries(config.socials)) {
                if (val && icons[key]) {
                    let href = val;
                    if (key === 'whatsapp' && !val.startsWith('http')) href = `https://wa.me/${val.replace(/[^0-9]/g, '')}`;
                    else if (!val.startsWith('http')) href = `https://${key}.com/${val}`;
                    
                    html += `<a href="${escapeHtml(href)}" target="_blank" style="color:inherit; transition:transform 0.2s; display:block;">${icons[key]}</a>`;
                }
            }
            html += '</div>';

            // 3. Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            html += '<div style="display:flex; flex-direction:column; gap:15px;">';
            config.links.forEach(link => {
                let borderStyle = '';
                let extraStyles = '';
                
                if (config.design.btnRadius === 'neubrutalism') {
                    borderStyle = `border: 2px solid ${config.design.textColor}; box-shadow: 4px 4px 0 ${config.design.textColor}; border-radius: 0;`;
                } else {
                    borderStyle = `border-radius: ${config.design.btnRadius}; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: none;`;
                }
                
                // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø¨Ø³ÙŠØ· Ù„Ù„Ù…Ø¹Ø§Ù†ÙŠØ© Ù„Ù€ Motion Pro
                if (config.design.theme === 'motion-pro') {
                    extraStyles = 'transform: scale(0.98); opacity: 0.9;';
                }

                html += `
                    <a href="${escapeHtml(link.url)}" target="_blank" style="
                        background-color: ${config.design.linkBgColor};
                        color: ${config.design.linkTextColor};
                        padding: 16px;
                        text-decoration: none;
                        font-weight: bold;
                        display: block;
                        width: 90%;
                        margin: 0 auto;
                        transition: all 0.2s;
                        ${borderStyle}
                        ${extraStyles}
                    ">${escapeHtml(link.title)}</a>
                `;
            });
            html += '</div>';

            els.preview.innerHTML = html;
        }

        // --- Ù…Ø²Ø§Ù…Ù†Ø© UI Ù…Ø¹ Config ---
        function syncUI() {
            els.name.value = config.profile.name;
            els.bio.value = config.profile.bio;
            
            // Ø§Ù„ØµÙˆØ±Ø©: Ø¥Ø°Ø§ ÙƒØ§Ù†Øª base64 (Ù…Ù† Ø±ÙØ¹ Ù…Ù„Ù)ØŒ Ù„Ø§ ØªØ¹Ø±Ø¶Ù‡Ø§ ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·ØŒ ÙÙ‚Ø· ÙÙŠ Ø²Ø± Ø§Ù„Ø±ÙØ¹
            if (config.profile.avatar.startsWith('data:')) {
                els.avatarUrlInput.value = '';
                els.avatarBtnText.textContent = "âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­ (Ø±Ø§Ø¨Ø· Ø·ÙˆÙŠÙ„)";
            } else {
                els.avatarUrlInput.value = config.profile.avatar;
                els.avatarBtnText.textContent = "Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ ğŸ“ (Ù‚Ø¯ ÙŠØ·ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·)";
            }
            
            // Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ
            els.socialsList.innerHTML = '';
            Object.keys(config.socials).forEach(key => {
                const div = document.createElement('div');
                div.className = 'form-group';
                div.innerHTML = `<label style="text-transform:capitalize">${key}</label><input type="text" data-social="${key}" value="${config.socials[key]}" placeholder="${key === 'whatsapp' ? 'Ù…Ø«Ø§Ù„: 201xxxxxxx' : 'username / url'}">`;
                els.socialsList.appendChild(div);
            });

            // Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
            renderLinksList();

            // Ø§Ù„Ø£Ù„ÙˆØ§Ù†
            els.colors.bg.value = config.design.bgColor.startsWith('#') ? config.design.bgColor : '#ffffff';
            els.colors.linkBg.value = config.design.linkBgColor;
            els.colors.linkText.value = config.design.linkTextColor;
            els.colors.text.value = config.design.textColor;
            els.theme.value = config.design.theme;
            els.btnStyle.value = config.design.btnRadius;

            renderPreview();
        }

        function renderLinksList() {
            // (Ø¨Ø§Ù‚ÙŠ ÙˆØ¸ÙŠÙØ© renderLinksList Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±)
            els.linksList.innerHTML = '';
            config.links.forEach((link, idx) => {
                const div = document.createElement('div');
                div.className = 'link-item';
                div.setAttribute('data-id', idx);
                div.innerHTML = `
                    <span class="drag-handle">â˜°</span>
                    <div style="flex:1;">
                        <input type="text" class="link-title" value="${escapeHtml(link.title)}" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†" style="margin-bottom:5px;">
                        <input type="url" class="link-url" value="${escapeHtml(link.url)}" placeholder="Ø§Ù„Ø±Ø§Ø¨Ø· (https://...)">
                    </div>
                    <button class="btn btn-danger delete-btn">ğŸ—‘ï¸</button>
                `;
                els.linksList.appendChild(div);
            });
        }

        // --- Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„Ø£Ø­Ø¯Ø§Ø« (Event Listeners) ---
        
        // 1. Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        [els.name, els.bio].forEach(el => el.addEventListener('input', () => {
            config.profile[el.id === 'profile-name' ? 'name' : 'bio'] = el.value;
            renderPreview();
        }));

        // 2. Ø§Ù„ØµÙˆØ±Ø© (Ø±Ø§Ø¨Ø· Ø£Ùˆ Ø±ÙØ¹)
        els.avatarUrlInput.addEventListener('input', () => {
            config.profile.avatar = els.avatarUrlInput.value || 'https://cdn-icons-png.flaticon.com/512/847/847969.png';
            els.avatarBtnText.textContent = "Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ ğŸ“ (Ù‚Ø¯ ÙŠØ·ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·)";
            els.avatarUpload.value = ''; // Ù…Ø³Ø­ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø±ÙÙˆØ¹ Ø¥Ø°Ø§ ØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø·
            renderPreview();
        });

        els.avatarUpload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                if (file.size > 500 * 1024) { 
                    alert('âš ï¸ Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹. ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø£Ù‚Ù„ Ù…Ù† 500 ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø±Ø§Ø¨Ø· Ø®Ø§Ø±Ø¬ÙŠ.');
                    e.target.value = '';
                    return;
                }
                const reader = new FileReader();
                reader.onload = function(event) {
                    config.profile.avatar = event.target.result; // Base64
                    els.avatarUrlInput.value = ''; // Ù…Ø³Ø­ Ø­Ù‚Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·
                    els.avatarBtnText.textContent = "âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­ (Ø±Ø§Ø¨Ø· Ø·ÙˆÙŠÙ„)";
                    renderPreview();
                };
                reader.readAsDataURL(file);
            }
        });

        // 3. Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ (Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯)
        els.socialsList.addEventListener('input', (e) => {
            if(e.target.tagName === 'INPUT') {
                config.socials[e.target.dataset.social] = e.target.value;
                renderPreview();
            }
        });

        // 4. Ø§Ù„Ø±ÙˆØ§Ø¨Ø· (Ø¥Ø¶Ø§ÙØ©ØŒ Ø­Ø°ÙØŒ ØªØ¹Ø¯ÙŠÙ„ØŒ ØªØ±ØªÙŠØ¨) (Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯)
        els.addLink.addEventListener('click', () => {
            config.links.push({ title: 'Ø±Ø§Ø¨Ø· Ø¬Ø¯ÙŠØ¯', url: '#' });
            syncUI();
        });

        els.linksList.addEventListener('input', (e) => {
            const idx = e.target.closest('.link-item').dataset.id;
            if(e.target.classList.contains('link-title')) config.links[idx].title = e.target.value;
            if(e.target.classList.contains('link-url')) config.links[idx].url = e.target.value;
            renderPreview();
        });

        els.linksList.addEventListener('click', (e) => {
            if(e.target.classList.contains('delete-btn') || e.target.parentElement.classList.contains('delete-btn')) {
                const idx = e.target.closest('.link-item').dataset.id;
                config.links.splice(idx, 1);
                syncUI();
            }
        });

        // ØªÙØ¹ÙŠÙ„ SortableJS Ù„Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª (Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯)
        new Sortable(els.linksList, {
            handle: '.drag-handle',
            animation: 150,
            ghostClass: 'sortable-ghost',
            onEnd: function (evt) {
                const item = config.links.splice(evt.oldIndex, 1)[0];
                config.links.splice(evt.newIndex, 0, item);
                syncUI(); 
            }
        });

        // 5. Ø§Ù„ØªØµÙ…ÙŠÙ…
        els.theme.addEventListener('change', (e) => {
            const t = themes[e.target.value];
            if(t) {
                config.design.theme = e.target.value;
                config.design.bgColor = t.bg;
                config.design.linkBgColor = t.lBg;
                config.design.linkTextColor = t.lTxt;
                config.design.textColor = t.txt;
                config.design.btnRadius = t.btnRadius || '8px'; // ÙŠØ³ØªØ®Ø¯Ù… Ù‚ÙŠÙ…Ø© Ø§Ù„Ø«ÙŠÙ… Ø£Ùˆ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
                syncUI();
            }
        });

        Object.values(els.colors).forEach(input => {
            input.addEventListener('input', () => {
                config.design.bgColor = els.colors.bg.value;
                config.design.linkBgColor = els.colors.linkBg.value;
                config.design.linkTextColor = els.colors.linkText.value;
                config.design.textColor = els.colors.text.value;
                config.design.theme = 'custom'; // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø«ÙŠÙ… Ù„Ù…Ø®ØµØµ
                els.theme.value = 'custom';
                renderPreview();
            });
        });

        els.btnStyle.addEventListener('change', (e) => {
            config.design.btnRadius = e.target.value;
            renderPreview();
        });

        // --- Ø§Ù„Ø­ÙØ¸ ÙˆØ§Ù„ØªØµØ¯ÙŠØ± ---
        
        // ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø·ÙˆÙŠÙ„ (Ù…ÙƒØ±Ø±Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Generate Ùˆ Shorten)
        function getLongUrl() {
            const jsonString = JSON.stringify(config);
            const compressed = LZString.compressToEncodedURIComponent(jsonString);
            return `${window.location.origin}${window.location.pathname}#data=${compressed}`;
        }

        // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø·ÙˆÙŠÙ„ Ù…Ø¹ QR Code
        els.generate.addEventListener('click', () => {
            const url = getLongUrl();
            
            els.modal.input.value = url;
            
            // ØªÙˆÙ„ÙŠØ¯ QR Code
            els.modal.qr.innerHTML = ''; 
            try {
                new QRCode(els.modal.qr, {
                    text: url,
                    width: 128,
                    height: 128,
                    colorDark : "#000000",
                    colorLight : "#ffffff",
                    correctLevel : QRCode.CorrectLevel.H
                });
            } catch (e) {
                 els.modal.qr.innerHTML = '<p style="color:red; font-weight:bold;">Ø§Ù„Ø±Ø§Ø¨Ø· Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªÙˆÙ„ÙŠØ¯ QR Code.</p>';
            }

            els.modal.self.style.display = 'flex';
        });
        
        // ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø· (Ø§Ù„Ø¬Ø¯ÙŠØ¯)
        els.shorten.addEventListener('click', async () => {
            const longUrl = getLongUrl();

            if (longUrl.length > 2000) {
                alert('âš ï¸ Ø§Ù„Ø±Ø§Ø¨Ø· Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹ (Ø·ÙˆÙ„Ù‡: ' + longUrl.length + ' Ø­Ø±Ù). Ù„Ù† ØªØªÙ…ÙƒÙ† Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªÙ‚ØµÙŠØ± Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© Ù…Ù† Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡. ÙŠØ±Ø¬Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø®Ø§Ø±Ø¬ÙŠ Ø£Ùˆ Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø·ÙˆÙŠÙ„ ÙŠØ¯ÙˆÙŠØ§Ù‹.');
                els.generate.click(); // Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„ÙØªØ­ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø·ÙˆÙŠÙ„
                return;
            }

            const originalText = els.shorten.innerText;
            els.shorten.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ‚ØµÙŠØ±... â³";
            els.shorten.disabled = true;

            try {
                const response = await fetch(`https://tinyurl.com/api-create.php?url=${encodeURIComponent(longUrl)}`);
                
                if (response.ok) {
                    const shortUrl = await response.text();
                    
                    els.modal.input.value = shortUrl;
                    els.modal.qr.innerHTML = '';
                    new QRCode(els.modal.qr, { text: shortUrl, width: 128, height: 128 });

                    els.modal.self.style.display = 'flex';
                    showToast("ØªÙ… ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰");
                } else {
                    throw new Error('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø©');
                }
            } catch (error) {
                console.error(error);
                alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±Ø§Ø¨Ø·. ØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø·ÙˆÙŠÙ„ ÙƒØ¨Ø¯ÙŠÙ„.");
                els.generate.click(); 
            } finally {
                els.shorten.innerText = originalText;
                els.shorten.disabled = false;
            }
        });


        els.modal.copy.addEventListener('click', () => {
            els.modal.input.select();
            document.execCommand('copy');
            showToast("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰");
        });

        els.modal.close.addEventListener('click', () => {
            els.modal.self.style.display = 'none';
        });

        // ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù HTML Ø«Ø§Ø¨Øª (Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯)
        els.download.addEventListener('click', () => {
            const finalHTML = generateFinalHTML(config);
            const blob = new Blob([finalHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `index-${Date.now()}.html`;
            a.click();
            URL.revokeObjectURL(url);
            showToast("Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù... ğŸ“¥");
        });

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        syncUI();
    }

    // --- ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© (Standalone) ---
    function generateFinalHTML(data) {
        const safeName = escapeHtml(data.profile.name);
        const safeBio = escapeHtml(data.profile.bio);
        const safeAvatar = escapeHtml(data.profile.avatar);
        const theme = data.design.theme;

        // Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ± (Ù…Ø¶Ù…Ù†Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¯Ø§Ù„Ø© Ù„ØªÙƒÙˆÙ† Ù…Ø³ØªÙ‚Ù„Ø©)
        const svgs = {
            twitter: '<svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>',
            instagram: '<svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.85s-.011 3.584-.069 4.85c-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07s-3.584-.012-4.85-.07c-3.252-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.85s.012-3.584.07-4.85c.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.85-.069zM12 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zm0 10.162a3.999 3.999 0 110-7.998 3.999 3.999 0 010 7.998z"/></svg>',
            facebook: '<svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg>',
            linkedin: '<svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452z"/></svg>',
            whatsapp: '<svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>'
        };

        let socialHTML = '';
        for (const [key, val] of Object.entries(data.socials)) {
            if (val && svgs[key]) {
                 let href = val;
                if (key === 'whatsapp' && !val.startsWith('http')) href = `https://wa.me/${val.replace(/[^0-9]/g, '')}`;
                else if (!val.startsWith('http')) href = `https://${key}.com/${val}`;
                socialHTML += `<a href="${escapeHtml(href)}" target="_blank" class="social-icon">${svgs[key]}</a>`;
            }
        }
        
        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ Simple Pro
        const avatarDisplay = theme === 'simple-pro' ? 'display: none;' : '';
        const avatarMargin = theme === 'simple-pro' ? '' : `<img src="${safeAvatar}" alt="${safeName}" class="avatar">`;

        let linksHTML = data.links.map(link => {
             let borderStyle = data.design.btnRadius === 'neubrutalism' 
                    ? `border: 2px solid ${data.design.textColor}; box-shadow: 4px 4px 0 ${data.design.textColor}; border-radius: 0;` 
                    : `border-radius: ${data.design.btnRadius}; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: none;`;
            
            return `<a href="${escapeHtml(link.url)}" target="_blank" class="link-btn" style="background-color:${data.design.linkBgColor}; color:${data.design.linkTextColor}; ${borderStyle}">${escapeHtml(link.title)}</a>`;
        }).join('');
        
        // Ø¥Ø¶Ø§ÙØ© CSS Ø®Ø§Øµ Ø¨Ø§Ù„Ù€ Motion Pro
        let motionProCSS = '';
        if (theme === 'motion-pro') {
            motionProCSS = `
                .link-btn:hover {
                    transform: translateY(-5px) scale(1.02);
                    filter: brightness(1.1);
                    box-shadow: 0 8px 15px rgba(0,0,0,0.2);
                }
                .social-icon:hover {
                    transform: scale(1.3) rotate(5deg);
                }
            `;
        }
        

        return `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>${safeName} | Links</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
<style>
    body { font-family: 'Cairo', sans-serif; margin: 0; padding: 40px 20px; min-height: 100vh; background: ${data.design.bgColor}; color: ${data.design.textColor}; display: flex; flex-direction: column; align-items: center; box-sizing: border-box; }
    .container { width: 100%; max-width: 600px; text-align: center; }
    .avatar { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 4px solid #fff; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 15px; ${avatarDisplay} }
    .name { font-size: 26px; font-weight: 900; margin: 0 0 10px; }
    .bio { font-size: 16px; opacity: 0.9; margin-bottom: 30px; line-height: 1.6; }
    .socials { display: flex; justify-content: center; gap: 18px; margin-bottom: 30px; }
    .social-icon { color: inherit; transition: transform 0.3s ease; display: inline-block; }
    .social-icon:hover { transform: scale(1.15); }
    .link-btn { display: block; width: 100%; padding: 18px; margin-bottom: 15px; text-decoration: none; font-weight: 700; font-size: 18px; box-sizing: border-box; transition: transform 0.3s, filter 0.3s; }
    .link-btn:hover { filter: brightness(0.95); }
    ${motionProCSS}
</style>
</head>
<body>
    <div class="container">
        ${avatarMargin}
        <h1 class="name">${safeName}</h1>
        <p class="bio">${safeBio}</p>
        <div class="socials">${socialHTML}</div>
        <div class="links">${linksHTML}</div>
    </div>
</body>
</html>`;
    }
    </script>
</body>
</html>
